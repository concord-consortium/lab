(function(){function i(){var a=+g.value;g.type==="range"&&(h.innerText=d3.format("4.1f")(a)),model.set({temperature:a})}function j(){layout.lennard_jones_forces_checkbox.checked?model.set_lennard_jones_forces(!0):model.set_lennard_jones_forces(!1)}function k(){layout.coulomb_forces_checkbox.checked?model.set({coulomb_forces:!0}):model.set({coulomb_forces:!1})}typeof console=="undefined"&&(window.console={},console.log=console.info=console.warn=console.error=function(){}),layout={version:"0.0.1"},layout.selection="",layout.display={},layout.canonical={width:1280,height:800},layout.regular_display=!1,layout.not_rendered=!0,layout.fontsize=!1,layout.cancelFullScreen=!1,layout.screen_factor=1,layout.checkbox_factor=1.1,layout.checkbox_scale=1.1,layout.canonical.width=1280,layout.canonical.height=800,layout.getDisplayProperties=function(a){if(!arguments.length)var a={};return a.screen={width:screen.width,height:screen.height},a.client={width:document.body.clientWidth,height:document.body.clientHeight},a.window={width:document.width,height:document.height},a.page={width:layout.getPageWidth(),height:layout.getPageHeight()},a},layout.checkForResize=function(){(layout.display.screen.width!=screen.width||layout.display.screen.height!=screen.height||layout.display.window.width!=document.width||layout.display.window.height!=document.height)&&layout.setupScreen()},layout.setupScreen=function(a){function e(){var b,c,d,e,f;d=Math.min(layout.display.page.height*.7,layout.display.page.width*.4),b=-1;while(++b<a.moleculeContainers.length)a.moleculeContainers[b].resize(d,d);e=a.moleculeContainers[0].scale(),f=e[0]/layout.display.page.width,c=(layout.display.page.width-e[0])*.34,d=layout.display.page.height*.3,b=-1;while(++b<a.potentialCharts.length)a.potentialCharts[b].resize(c,d);c=(layout.display.page.width-e[0])*.34,d=layout.display.page.height*.3,b=-1;while(++b<a.speedDistributionCharts.length)a.speedDistributionCharts[b].resize(c,d);c=(layout.display.page.width-e[0])*.7,d=layout.display.page.height*.39+0,b=-1;while(++b<a.energyCharts.length)a.energyCharts[b].resize(c,d)}function f(){var b,c,d;d=layout.display.page.height*.7,b=-1;while(++b<a.moleculeContainers.length)a.moleculeContainers[b].resize(d,d);c=layout.display.page.width*.24,d=layout.display.page.height*.35,b=-1;while(++b<a.potentialCharts.length)a.potentialCharts[b].resize(c,d);c=layout.display.page.width*.22,d=layout.display.page.height*.35,b=-1;while(++b<a.speedDistributionCharts.length)a.speedDistributionCharts[b].resize(c,d);c=layout.display.page.width*.47+5,d=layout.display.page.height*.4+0,b=-1;while(++b<a.energyCharts.length)a.energyCharts[b].resize(c,d)}function g(){var b,c,d,e,f,g=document.getElementById("description-right");d=Math.min(layout.display.page.height*.7,layout.display.page.width*.53),a.moleculeContainers[0].resize(d,d),e=a.moleculeContainers[0].scale(),f=e[0]/layout.display.page.width,f>.53&&(d*=.53/f,a.moleculeContainers[0].resize(d,d))}function h(){var b,c,d,e,f;d=Math.min(layout.display.page.height*.78,layout.display.page.width*.75),a.moleculeContainers[0].resize(d,d),e=a.moleculeContainers[0].scale(),f=e[0]/layout.display.page.width,f>.75&&(d*=.75/f,a.moleculeContainers[0].resize(d,d))}function i(){var b=layout.display.page.height*.7;a.moleculeContainers[0].resize(b,b)}function j(){var a=document.getElementById("description-right");a===null}var b=document.fullScreen||document.webkitIsFullScreen||document.mozFullScreen;layout.display=layout.getDisplayProperties(),layout.regular_display||(layout.regular_display=layout.getDisplayProperties());if(b){layout.screen_factor_width=layout.display.page.width/layout.canonical.width,layout.screen_factor_height=layout.display.page.height/layout.canonical.height,layout.screen_factor=layout.screen_factor_height,layout.checkbox_factor=Math.max(.8,layout.checkbox_scale*layout.screen_factor),layout.bodycss.style.fontSize=layout.screen_factor+"em",layout.not_rendered=!0;switch(layout.selection){case"simple-screen":i(),j();break;case"simple-static-screen":layout.not_rendered&&(i(),setupDescriptionRight());break;case"simple-iframe":i(),j();break;default:f()}}else{layout.cancelFullScreen?(layout.cancelFullScreen=!1,layout.regular_display=layout.previous_display):layout.regular_display=layout.getDisplayProperties(),layout.screen_factor_width=layout.display.page.width/layout.canonical.width,layout.screen_factor_height=layout.display.page.height/layout.canonical.height,layout.screen_factor=layout.screen_factor_height,layout.checkbox_factor=Math.max(.8,layout.checkbox_scale*layout.screen_factor);switch(layout.selection){case"simple-screen":layout.bodycss.style.fontSize=layout.screen_factor+"em",setupSimpleMoleculeContainer(),setupDescriptionRight();break;case"simple-static-screen":if(layout.not_rendered){var d=Math.min(layout.screen_factor_width*1.1,layout.screen_factor_height);layout.bodycss.style.fontSize=d+"em",g(),layout.not_rendered=!1}break;case"simple-iframe":var d=Math.min(layout.screen_factor_width*1.5,layout.screen_factor_height);layout.bodycss.style.fontSize=d+"em",h();break;case"full-static-screen":if(layout.not_rendered){var d=Math.min(layout.screen_factor_width*1.5,layout.screen_factor_height);layout.bodycss.style.fontSize=d+"em",e(),layout.not_rendered=!1}break;default:layout.bodycss.style.fontSize=layout.screen_factor+"em",e()}layout.regular_display=layout.getDisplayProperties()}layout.transform&&$("input[type=checkbox]").css(layout.transform,"scale("+layout.checkbox_factor+","+layout.checkbox_factor+")"),layout.setupTemperature(model),layout.temperature_control_checkbox&&(model.addPropertiesListener(["temperature_control"],layout.temperatureControlUpdate),layout.temperatureControlUpdate()),c&&(c.style.display="none")},layout.getStyleForSelector=function(a){var b,c=document.styleSheets;for(var d=0;d<c.length;d++)if(c[d])try{b=c[d].rules||c[d].cssRules;if(b)for(var e=0;e<b.length;e++)if(b[e].selectorText==a)return b[e]}catch(f){}return!1},layout.getPageHeight=function(){var a;return self.innerHeight?a=self.innerHeight:document.documentElement&&document.documentElement.clientHeight?a=document.documentElement.clientHeight:document.body&&(a=layout.display.window.height),a},layout.getPageWidth=function(){var a;return self.innerWidth?a=self.innerWidth:document.documentElement&&document.documentElement.clientWidth?a=document.documentElement.clientWidth:document.body&&(a=window.width),a},layout.getTransformProperty=function(a){var b=["transform","WebkitTransform","msTransform","MozTransform","OTransform"],c;while(c=b.shift())if(typeof a.style[c]!="undefined")return c;return!1};var a=document.getElementById("description-right");a!==null&&(layout.fontsize=parseInt(layout.getStyleForSelector("#description-right").style.fontSize)),layout.bodycss=layout.getStyleForSelector("body"),layout.transform=layout.getTransformProperty(document.body),layout.moleculeContainer=function(a,b){function X(a,j){var k=model.size(),l=k[0]/k[1];arguments.length?(f=j,d.style.height=f+"px",e=f*l):(f=c.property("clientHeight"),e=f*l),d.style.width=e+"px",i=layout.screen_factor,layout.screen_factor_width&&layout.screen_factor_height&&(i=Math.min(layout.screen_factor_width,layout.screen_factor_height)),i=e/600,o={top:b.title?40*layout.screen_factor:20,right:25,bottom:b.xlabel?56*layout.screen_factor:20,left:b.ylabel?60*layout.screen_factor:25};if(b.playback_controller||b.play_only_controller)o.bottom+=30*i;return h=f-o.top-o.bottom,g=e-o.left-o.right,p={width:g,height:h},M=d.offsetLeft+o.left,N=d.offsetTop+o.top,C=o.left+p.width/2-60,b.playback_controller&&(C-=50*i),D=f-42*i,q=p.width,r=p.height,v=d3.scale.linear().domain([b.xmin,b.xmax]).range([0,q]),w=v.copy(),x=Math.NaN,y=d3.scale.linear().domain([b.ymax,b.ymin]).nice().range([0,r]).nice(),z=y.copy(),A=Math.NaN,B=null,[e,f]}function Y(){return F+E(model.getTime()/1e3)+G}function Z(a){return nodes[model.INDICES.X][a]}function $(a){return nodes[model.INDICES.Y][a]}function _(a){return nodes[model.INDICES.RADIUS][a]}function ba(a){return nodes[model.INDICES.SPEED][a]}function bb(a){return nodes[model.INDICES.VX][a]}function bc(a){return nodes[model.INDICES.VY][a]}function bd(a){return nodes[model.INDICES.AX][a]}function be(a){return nodes[model.INDICES.AY][a]}function bf(a){return nodes[model.INDICES.CHARGE][a]}function bg(){function a(){d3.event&&d3.event.transform&&isNaN(x)&&isNaN(A)&&d3.event.transform(v,y);var a=v.tickFormat(10),c=y.tickFormat(10);if(b.xunits){var d=k.selectAll("g.x").data(v.ticks(10),String).attr("transform",s);d.select("text").text(a);var e=d.enter().insert("svg:g","a").attr("class","x").attr("transform",s);b.grid_lines&&e.append("svg:line").attr("stroke",u).attr("y1",0).attr("y2",p.height),e.append("svg:text").attr("y",p.height).attr("dy","1em").attr("text-anchor","middle").text(a),d.exit().remove()}if(b.xunits){var f=k.selectAll("g.y").data(y.ticks(10),String).attr("transform",t);f.select("text").text(c);var g=f.enter().insert("svg:g","a").attr("class","y").attr("transform",t).attr("background-fill","#FFEEB6");b.grid_lines&&g.append("svg:line").attr("stroke",u).attr("x1",0).attr("x2",p.width),g.append("svg:text").attr("x",-3).attr("dy",".35em").attr("text-anchor","end").text(c),b.model_time_label&&n.text(Y()),f.exit().remove()}}function g(){H=k.append("svg").attr("class","container").attr("top",0).attr("left",0).attr("width",p.width).attr("height",p.height).attr("viewBox","0 0 "+p.width+" "+p.height),I=H.append("defs").append("radialGradient").attr("id","neg-grad").attr("cx","50%").attr("cy","47%").attr("r","53%").attr("fx","35%").attr("fy","30%"),I.append("stop").attr("stop-color","#ffefff").attr("offset","0%"),I.append("stop").attr("stop-color","#fdadad").attr("offset","40%"),I.append("stop").attr("stop-color","#e95e5e").attr("offset","80%"),I.append("stop").attr("stop-color","#fdadad").attr("offset","100%"),J=H.append("defs").append("radialGradient").attr("id","pos-grad").attr("cx","50%").attr("cy","47%").attr("r","53%").attr("fx","35%").attr("fy","30%"),J.append("stop").attr("stop-color","#dfffff").attr("offset","0%"),J.append("stop").attr("stop-color","#9abeff").attr("offset","40%"),J.append("stop").attr("stop-color","#767fbf").attr("offset","80%"),J.append("stop").attr("stop-color","#9abeff").attr("offset","100%"),K=H.append("defs").append("radialGradient").attr("id","neu-grad").attr("cx","50%").attr("cy","47%").attr("r","53%").attr("fx","35%").attr("fy","30%"),K.append("stop").attr("stop-color","#dfffef").attr("offset","0%"),K.append("stop").attr("stop-color","#75a643").attr("offset","40%"),K.append("stop").attr("stop-color","#2a7216").attr("offset","80%"),K.append("stop").attr("stop-color","#75a643").attr("offset","100%")}function h(){k.selectAll("circle").data(atoms).attr("r",function(a,b){return v(_(b))})}function q(){if(typeof atoms=="undefined"||!atoms)return;var a=model.getLJCalculator().coefficients();H.selectAll("circle").remove(),H.selectAll("g").remove(),O=H.selectAll("circle").data(atoms),O.enter().append("circle").attr("r",function(a,b){return v(_(b))}).attr("cx",function(a,b){return v(Z(b))}).attr("cy",function(a,b){return y($(b))}).style("cursor","crosshair").style("fill",function(a,b){return model.get("coulomb_forces")?v(bf(b))>0?"url('#pos-grad')":"url('#neg-grad')":"url('#neu-grad')"}).on("mousedown",w).on("mouseout",E);var c=v(a.rmin*.5*1.5);model.get("mol_number")>100&&(c*=.9),P=H.selectAll("g.label").data(atoms),Q=P.enter().append("g").attr("class","label").attr("transform",function(a,b){return"translate("+v(Z(b))+","+y($(b))+")"}),b.atom_mubers?Q.append("text").attr("class","index").attr("font-size",c).attr("style","font-weight: bold; opacity: .7").attr("x",0).attr("y","0.31em").text(function(a){return a.index}):Q.append("text").attr("class","index").attr("font-size",c).attr("style","font-weight: bold; opacity: .7").attr("x","-0.31em").attr("y","0.31em").text(function(a,b){if(layout.coulomb_forces_checkbox.checked)return v(bf(b))>0?"+":"â€“";return})}function r(a){}function w(a,b){L?(T.style("opacity",1e-6),T.style("display","none"),L=!1):(d3.event.shiftKey?L=b:L=!1,z(b))}function z(a){T.style("opacity",1).style("display","inline").style("background","rgba(100%, 100%, 100%, 0.5)").style("left",v(nodes[model.INDICES.X][a])+M+16+"px").style("top",y(nodes[model.INDICES.Y][a])+N-30+"px").transition().duration(250),U.text(Y()+"\n"+"speed: "+d3.format("+6.3e")(ba(a))+"\n"+"vx:    "+d3.format("+6.3e")(bb(a))+"\n"+"vy:    "+d3.format("+6.3e")(bc(a))+"\n"+"ax:    "+d3.format("+6.3e")(bd(a))+"\n"+"ay:    "+d3.format("+6.3e")(be(a))+"\n")}function B(a){}function E(){typeof L!="number"&&T.style("opacity",1e-6)}function F(){b.model_time_label&&n.text(Y()),P=c.selectAll("g.label").data(atoms),P.attr("transform",function(a,b){return"translate("+v(Z(b))+","+y($(b))+")"}),O=c.selectAll("circle").data(atoms),O.attr("cx",function(a,b){return v(nodes[model.INDICES.X][b])}).attr("cy",function(a,b){return y(nodes[model.INDICES.Y][b])}).attr("r",function(a,b){return v(nodes[model.INDICES.RADIUS][b])}),typeof L=="number"&&z(L)}X(),k===undefined?(j=d3.select(d).append("svg").attr("width",e).attr("height",f),k=j.append("g").attr("transform","translate("+o.left+","+o.top+")"),l=k.append("rect").attr("class","plot").attr("width",p.width).attr("height",p.height).style("fill","#EEEEEE"),b.title&&k.append("text").attr("class","title").text(b.title).attr("x",p.width/2).attr("dy","-1em").style("text-anchor","middle"),b.xlabel&&k.append("text").attr("class","xlabel").text(b.xlabel).attr("x",p.width/2).attr("y",p.height).attr("dy","2.4em").style("text-anchor","middle"),b.ylabel&&k.append("g").append("text").attr("class","ylabel").text(b.ylabel).style("text-anchor","middle").attr("transform","translate(-40 "+p.height/2+") rotate(-90)"),b.model_time_label&&(n=k.append("text").attr("class","model_time_label").text(Y()).attr("x",p.width-100).attr("y",p.height).attr("dy","2.4em").style("text-anchor","start")),b.playback_controller&&(m=new PlaybackComponentSVG(j,model_player,C,D,i)),b.play_only_controller&&(m=new PlayOnlyComponentSVG(j,model_player,C,D,i)),T=d3.select("#viz").append("div").attr("class","tooltip").style("opacity",1e-6),U=T.append("pre"),a(),g()):(d3.select(d).select("svg").attr("width",e).attr("height",f),k.select("svg").attr("width",e).attr("height",f),k.select("rect.plot").attr("width",p.width).attr("height",p.height).style("fill","#EEEEEE"),k.select("svg.container").attr("top",0).attr("left",0).attr("width",p.width).attr("height",p.height).attr("viewBox","0 0 "+p.width+" "+p.height),b.title&&k.select("text.title").attr("x",p.width/2).attr("dy","-1em"),b.xlabel&&k.select("text.xlabel").attr("x",p.width/2).attr("y",p.height),b.ylabel&&k.select("text.ylabel").attr("transform","translate(-40 "+p.height/2+") rotate(-90)"),b.model_time_label&&n.text(Y()).attr("x",p.width-100).attr("y",p.height),k.selectAll("g.x").remove(),k.selectAll("g.y").remove(),O&&(h(),O.attr("cx",function(a,b){return v(Z(b))}).attr("cy",function(a,b){return y($(b))}).attr("r",function(a,b){return v(_(b))}),P.attr("transform",function(a,b){return"translate("+v(Z(b))+","+y($(b))+")"})),(b.playback_controller||b.play_only_controller)&&m.position(C,D,i),a()),bg.node=d,bg.updateMoleculeRadius=h,bg.setup_particles=q,bg.update_molecule_positions=F,bg.scale=X,bg.playback_component=m}var c=d3.select(a),d=c.node(),e=c.property("clientWidth"),f=c.property("clientHeight"),g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=d3.format("5.2f"),F="time: ",G=" (ps)",H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V={title:!1,xlabel:!1,ylabel:!1,playback_controller:!1,play_only_controller:!0,model_time_label:!1,grid_lines:!1,xunits:!1,yunits:!1,atom_mubers:!1,xmin:0,xmax:10,ymin:0,ymax:10};if(b)for(var W in V)b[W]===undefined&&(b[W]=V[W]);else b=V;return X(e,f),s=function(a,b){return"translate("+v(a)+",0)"},t=function(a,b){return"translate(0,"+y(a)+")"},u=function(a,b){return a?"#ccc":"#666"},bg.resize=function(a,b){bg.scale(a,b),bg(),bg.setup_particles()},d&&bg(),bg},layout.potentialChart=function(a,b,c){function D(){var a,c,d,e,f,g;w=b.getLJCalculator(),z.coefficients=w.coefficients(),a=z.coefficients.sigma,c=z.coefficients.epsilon,d=z.coefficients.rmin,z.xmax=a*3,z.xmin=Math.floor(a/2),z.ymax=.4,z.ymin=Math.ceil(c*1)-1,z.variables[0].x=d,z.variables[0].y=c,z.variables[1].x=a,z.variables[1].y=0,A.length=0;for(f=a*.5;f<z.xmax*3;f+=.001)e=-w.potential(f),Math.abs(e)<100&&A.push([f,e])}function E(a,b){f=a,g=b,e.style.width=f+"px",e.style.height=g+"px",h={top:c.title?40:20,right:35,bottom:c.xlabel?56:30,left:c.ylabel?60:25},width=f-h.left-h.right,height=g-h.top-h.bottom,i={width:width,height:height},j=i.width,k=i.height,o.domain([z.xmin,z.xmax]).range([0,j]),q.domain([z.ymax,z.ymin]).range([0,k]),p=Math.NaN,r=Math.NaN,s=null}function F(){function a(){d3.event&&d3.event.transform&&isNaN(p)&&isNaN(r)&&d3.event.transform(x,y);var b=o.tickFormat(5),c=q.tickFormat(10),d=u.selectAll("g.x").data(o.ticks(5),String).attr("transform",l);d.select("text").text(b);var e=d.enter().insert("g","a").attr("class","x").attr("transform",l);e.append("line").attr("stroke",n).attr("y1",0).attr("y2",i.height),e.append("text").attr("y",i.height).attr("dy","1em").attr("text-anchor","middle").style("cursor","ew-resize").text(b).on("mouseover",function(a){d3.select(this).style("font-weight","bold")}).on("mouseout",function(a){d3.select(this).style("font-weight","normal")}).on("mousedown",function(a){var b=d3.svg.mouse(u[0][0]);p=o.invert(b[0])}),d.exit().remove();var f=u.selectAll("g.y").data(q.ticks(10),String).attr("transform",m);f.select("text").text(c);var g=f.enter().insert("g","a").attr("class","y").attr("transform",m).attr("background-fill","#FFEEB6");g.append("line").attr("stroke",n).attr("x1",0).attr("x2",i.width),g.append("text").attr("x",-3).attr("dy",".35em").attr("text-anchor","end").style("cursor","ns-resize").text(c).on("mouseover",function(a){d3.select(this).style("font-weight","bold")}).on("mouseout",function(a){d3.select(this).style("font-weight","normal")}).on("mousedown",function(a){var b=d3.svg.mouse(u[0][0]);r=q.invert(b[1])}),f.exit().remove(),v.call(d3.behavior.zoom().x(o).y(q).scaleExtent([1,8]).on("zoom",a)),j()}function j(){var a=u.selectAll("circle").data(z.variables,function(a){return a}),b=u.select("path").attr("d",line(A)),c=o.domain()[1]-o.domain()[0];a.enter().append("circle").attr("class",function(a){return a===t?"selected":null}).attr("cx",function(a){return o(a.x)}).attr("cy",function(a){return q(a.y)}).style("cursor",function(a){return a.cursorStyle}).attr("r",8).on("mousedown",function(a){a.coefficient=="epsilon"?a.x=z.coefficients.rmin:a.y=0,coefficient_selected=t=a,j()}),a.attr("class",function(a){return a===coefficient_selected?"selected":null}).attr("cx",function(a){return o(a.x)}).attr("cy",function(a){return q(a.y)}),a.exit().remove(),d3.event&&d3.event.keyCode&&(d3.event.preventDefault(),d3.event.stopPropagation())}function k(){d.style("cursor","move")}function s(){if(!t)return;e.onselectstart=function(){return!1};var a=d3.svg.mouse(u.node()),d,f;t.coefficient=="epsilon"?(d=z.coefficients.rmin,f=q.invert(Math.max(0,Math.min(i.height,a[1]))),f>c.epsilon_max&&(f=c.epsilon_max),f<c.epsilon_min&&(f=c.epsilon_min),b.set({epsilon:f})):(f=0,d=o.invert(Math.max(0,Math.min(i.width,a[0]))),d<c.sigma_min&&(d=c.sigma_min),d>c.sigma_max&&(d=c.sigma_max),b.set({sigma:d})),t.x=d,t.y=f,j()}function w(){isNaN(p)||(e.onselectstart=function(){return!0},a(),p=Math.NaN,d3.event.preventDefault(),d3.event.stopPropagation()),isNaN(r)||(a(),r=Math.NaN,d3.event.preventDefault(),d3.event.stopPropagation()),t=null}E(f,g),u===undefined?(u=d3.select(e).append("svg").attr("width",f).attr("height",g).append("svg:g").attr("transform","translate("+h.left+","+h.top+")"),v=u.append("rect").attr("class","plot").attr("width",i.width).attr("height",i.height).style("fill","#EEEEEE").attr("pointer-events","all"),v.call(d3.behavior.zoom().x(o).y(q).scaleExtent([1,8]).on("zoom",a)),u.append("svg").attr("class","linebox").attr("top",0).attr("left",0).attr("width",i.width).attr("height",i.height).attr("viewBox","0 0 "+i.width+" "+i.height).append("path").attr("class","line").attr("d",line(A)),c.title&&u.append("text").attr("class","title").text(c.title).attr("x",i.width/2).attr("dy","-1em").style("text-anchor","middle"),c.xlabel&&u.append("text").attr("class","xlabel").text(c.xlabel).attr("x",i.width/2).attr("y",i.height).attr("dy","2.4em").style("text-anchor","middle"),c.ylabel&&u.append("g").append("text").attr("class","ylabel").text(c.ylabel).style("text-anchor","middle").attr("transform","translate(-40 "+i.height/2+") rotate(-90)"),u.on("mousemove",s).on("mouseup",w),a()):(d3.select(e).select("svg").attr("width",f).attr("height",g),u.select("svg").attr("width",f).attr("height",g),u.select("rect.plot").attr("width",i.width).attr("height",i.height).style("fill","#EEEEEE"),u.select("svg.container").attr("top",0).attr("left",0).attr("width",i.width).attr("height",i.height).attr("viewBox","0 0 "+i.width+" "+i.height),u.select("svg.linebox").attr("top",0).attr("left",0).attr("width",i.width).attr("height",i.height).attr("viewBox","0 0 "+i.width+" "+i.height),c.title&&u.select("text.title").attr("x",i.width/2).attr("dy","-1em"),c.xlabel&&u.select("text.xlabel").attr("x",i.width/2).attr("y",i.height),c.ylabel&&u.select("text.ylabel").attr("transform","translate(-40 "+i.height/2+") rotate(-90)"),u.selectAll("g.x").remove(),u.selectAll("g.y").remove(),a()),d.on("mousemove",function(b){document.onselectstart=function(){return!0};var c=d3.svg.mouse(u[0][0]);if(!isNaN(p)){var d=o.invert(c[0]),e=o.domain()[0],f=o.domain()[1],g=f-e;if(d!==0){var h,i,j;i=g/p,h=1+(p/d-1)*(g/(p-e))/i,j=[e,e+g*h],o.domain(j),a()}d3.event.preventDefault(),d3.event.stopPropagation()}if(!isNaN(r)){var k=q.invert(c[1]),l=q.domain()[1],m=q.domain()[0],n=m-l;if(k!==0){var s,t,v;t=n/r,s=1-(k/r-1)*(n/(r-l))/t,v=[l+n*s,l],q.domain(v),a()}d3.event.preventDefault(),d3.event.stopPropagation()}}).on("mouseup",function(b){document.onselectstart=function(){return!0},isNaN(p)||(a(),p=Math.NaN,d3.event.preventDefault(),d3.event.stopPropagation()),isNaN(r)||(a(),r=Math.NaN,d3.event.preventDefault(),d3.event.stopPropagation())}),F.node=e,F.scale=E,F.updateLJData=D,F.update=j,F.redraw=a}var d=d3.select(a),e=d.node(),f=d.property("clientWidth"),g=d.property("clientHeight"),h,i,j,k,l,m,n,o=d3.scale.linear(),p,q=d3.scale.linear(),r,s,t,u,v,w,z={},A=[],B={title:"Lennard-Jones potential",xlabel:"Radius",ylabel:"Potential Energy"};if(c)for(var C in B)c[C]===undefined&&(c[C]=B[C]);else c=B;return z.variables=[],z.variables[0]={coefficient:"epsilon",cursorStyle:"ns-resize"},z.variables[1]={coefficient:"sigma",cursorStyle:"ew-resize"},D(),t=!1,coefficient_selected=z.variables[0],E(f,g),l=function(a,b){return"translate("+o(a)+",0)"},m=function(a,b){return"translate(0,"+q(a)+")"},n=function(a,b){return Math.abs(a)>1e-4?"#ccc":"#666"},line=d3.svg.line().x(function(a,b){return o(A[b][0])}).y(function(a,b){return q(A[b][1])}),F.resize=function(a,b){F.scale(a,b),F()},F.ljUpdate=function(){F.updateLJData(),F.redraw()},e&&F(),F},layout.speedDistributionChart=function(a,b){function J(){E=model.get_speed(),b.xmax=d3.max(E),b.xmin=d3.min(E),b.quantile=d3.quantile(E,.1),w=b.ymax,n=d3.scale.linear().domain([b.xmin,b.xmax]).range([0,i]),q=d3.scale.linear().domain([b.ymax,b.ymin]).nice().range([0,j])}function K(){E.length>2&&(G=d3.layout.histogram().frequency(!1).bins(n.ticks(60))(E),t=(h.width-G.length)/G.length,v=(b.xmax-b.xmin)/G.length,z=d3.max(G,function(a){return a.y}))}function L(a,c){e=a,f=c,d.style.width=e+"px",d.style.height=f+"px",g={top:b.title?40:20,right:35,bottom:b.xlabel?56:30,left:b.ylabel?60:25},width=e-g.left-g.right,height=f-g.top-g.bottom,h={width:width,height:height},i=h.width,j=h.height,n=d3.scale.linear().domain([b.xmin,b.xmax]).range([0,i]),q=d3.scale.linear().domain([b.ymax,b.ymin]).nice().range([0,j]).nice(),J(),K()}function M(){function a(){d3.event&&d3.event.transform&&isNaN(p)&&isNaN(s)&&d3.event.transform(x,y);var a=q.tickFormat(10),b=A.selectAll("g.y").data(q.ticks(5),String).attr("transform",l);b.select("text").text(a);var d=b.enter().insert("g","a").attr("class","y").attr("transform",l).attr("background-fill","#FFEEB6");d.append("line").attr("stroke",m).attr("x1",0).attr("x2",h.width),d.append("text").attr("x",-3).attr("dy",".35em").attr("text-anchor","end").style("cursor","ns-resize").text(a).on("mouseover",function(a){d3.select(this).style("font-weight","bold")}).on("mouseout",function(a){d3.select(this).style("font-weight","normal")}).on("mousedown",function(a){var b=d3.svg.mouse(A[0][0]);s=y.invert(b[1])}),b.exit().remove(),c()}function c(){J(),E.length>2&&(kde=science.stats.kde().sample(E),n.domain([b.xmin,b.xmax]),G=d3.layout.histogram().frequency(!0).bins(n.ticks(60))(E),t=(h.width-G.length)/G.length,v=(b.xmax-b.xmin)/G.length,z=d3.max(G,function(a){return a.y}),A.selectAll("g.bar").remove(),C=A.selectAll("g.bar").data(G),C.enter().append("g").attr("class","bar").attr("transform",function(a,b){return"translate("+n(a.x)+","+(j-q(w-a.y))+")"}).append("rect").attr("class","bar").attr("fill","steelblue").attr("width",t).attr("height",function(a){return q(w-a.y)}))}L(e,f),A===undefined?(A=d3.select(d).append("svg").attr("width",e).attr("height",f).append("g").attr("transform","translate("+g.left+","+g.top+")"),B=A.append("rect").attr("class","plot").attr("width",h.width).attr("height",h.height).style("fill","#EEEEEE"),b.title&&A.append("text").attr("class","title").text(b.title).attr("x",h.width/2).attr("dy","-1em").style("text-anchor","middle"),b.xlabel&&A.append("text").attr("class","xlabel").text(b.xlabel).attr("x",h.width/2).attr("y",h.height).attr("dy","2.4em").style("text-anchor","middle"),b.ylabel&&A.append("g").append("text").attr("class","ylabel").text(b.ylabel).style("text-anchor","middle").attr("transform","translate(-40 "+h.height/2+") rotate(-90)"),a()):(d3.select(d).select("svg").attr("width",e).attr("height",f),A.select("rect.plot").attr("width",h.width).attr("height",h.height).style("fill","#EEEEEE"),b.title&&A.select("text.title").attr("x",h.width/2).attr("dy","-1em"),b.xlabel&&A.select("text.xlabel").attr("x",h.width/2).attr("y",h.height),b.ylabel&&A.select("text.ylabel").attr("transform","translate(-40 "+h.height/2+") rotate(-90)"),A.selectAll("g.x").remove(),A.selectAll("g.y").remove(),a()),M.node=d,M.scale=L,M.update=c,M.redraw=a}var c=d3.select(a),d=c.node(),e=c.property("clientWidth"),f=c.property("clientHeight"),g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,z,A,B,C,D,E,F,G,H={title:"Distribution of Speeds",xlabel:null,ylabel:"Count",xmax:2,xmin:0,ymax:15,ymin:0,quantile:.01};if(b)for(var I in H)b[I]===undefined&&(b[I]=H[I]);else b=H;return L(e,f),k=function(a,b){return"translate("+n(a)+",0)"},l=function(a,b){return"translate(0,"+q(a)+")"},m=function(a,b){return a?"#ccc":"#666"},M.resize=function(a,b){M.scale(a,b),M()},d&&M(),M};var b=document.getElementById("start-benchmarks"),c=document.getElementById("benchmarks-table"),d=[{name:"molecules",run:function(){return model.get_atoms().length}},{name:"temperature",run:function(){return model.get("temperature")}},{name:"100 Steps (steps/s)",run:function(){controller.modelStop();var a=+Date.now(),b=-1;while(b++<100)model.tick();return elapsed=Date.now()-a,d3.format("5.1f")(100/elapsed*1e3)}},{name:"100 Steps w/graphics",run:function(){controller.modelStop();var a=+Date.now(),b=-1;while(b++<100)model.tick(),controller.modelListener();return elapsed=Date.now()-a,d3.format("5.1f")(100/elapsed*1e3)}}];b&&(b.onclick=function(){benchmark.run(c,d)}),layout.datatable_visible=!1;var e=document.getElementById("toggle-datatable"),f=document.getElementById("datatable-table");layout.hide_datatable=function(){f&&(f.style.display="none")},layout.render_datatable=function(a){function j(){return f.getElementsByTagName("tr").length==0}function k(a){a=a||"data";var b=f.appendChild(document.createElement("tr"));return b.className=a,b}function l(a,b,c,d){c=c||"td",d=d||1;var e=a.appendChild(document.createElement(c));e.textContent=b,d>1&&(e.colSpan=d)}function m(a,b,c){c=c||"td";var d;d=-1;while(++d<b.length)l(a,b[d])}function n(a,b,c){c=c||"td";var d=a.getElementsByTagName(c),f=0;if(d.length>0){d[0].textContent=b;while(++f<d.length)d[f].textContent=i[f](nodes[model.INDICES[e[f]]][b])}f--;while(++f<e.length)l(a,i[f](nodes[model.INDICES[e[f]]][b]))}function o(a,b){j()&&l(k("title"),a,"th"),l(results_row,b)}function p(a,b,c){c=c||1;var d;d=-1;while(++d<b.length)l(a,b[d],"th",c)}function q(a){var b=-1,c=d.length;while(++b<a)b>=d.length&&k();while(--c>=b)f.removeChild(d[b]);return f.getElementsByClassName("data")}function r(a,b){var c=-1;while(++c<b.length)l(a,b[c])}function s(a,b,c,d){var e;e=-1;while(++e<d.length)r(b[e],d[e])}f.style.display="";var b,c=f.getElementsByClassName("title"),d=f.getElementsByClassName("data"),e=["PX","PY","X","Y","VX","VY","AX","AY","SPEED","RADIUS","MASS","CHARGE"],g=d3.format(" 2d"),h=d3.format(" 3.4f"),i=[g,h,h,h,h,h,h,h,h,h,h,h,g];a=a||!1;if(c.length==0){var t=k("title");p(t,e),d=q(atoms.length)}a&&(d=q(atoms.length)),b=-1;while(++b<atoms.length)n(d[b],b)},e&&(e.onclick=function(){layout.datatable_visible?(layout.datatable_visible=!1,e.textContent="Show Data Table",f.style.display="none"):(layout.datatable_visible=!0,e.textContent="Hide Data Table",layout.render_datatable(),f.style.display="")});var g=document.getElementById("select-temperature"),h=document.createElement("span");layout.setupTemperature=function(a){if(g){if(Modernizr.inputtypes.range){var b=document.createElement("input");b.type="range",b.min="0",b.max="25",b.step="0.5",b.value=a.get("temperature"),g.parentNode.replaceChild(b,g),b.id="select-temperature",g=b,h.id="select-temperature-display",h.innerText=b.value,g.parentNode.appendChild(h),g=document.getElementById("select-temperature")}g.onchange=i}},layout.temperature_control_checkbox=document.getElementById("temperature-control-checkbox"),layout.temperatureControlHandler=function(){layout.temperature_control_checkbox.checked?model.set({temperature_control:!0}):model.set({temperature_control:!1})},layout.temperatureControlUpdate=function(){layout.temperature_control_checkbox.checked=model.get("temperature_control")},layout.temperature_control_checkbox&&(layout.temperature_control_checkbox.onchange=layout.temperatureControlHandler),layout.lennard_jones_forces_checkbox=document.getElementById("lennard-jones-forces-checkbox"),layout.lennard_jones_forces_checkbox&&(layout.lennard_jones_forces_checkbox.onchange=j),layout.coulomb_forces_checkbox=document.getElementById("coulomb-forces-checkbox"),layout.coulomb_forces_checkbox&&(layout.coulomb_forces_checkbox.onchange=k);var l=document.getElementById("stats");layout.displayStats=function(){var a=model.ke(),b=model.pe(),c=a+b;l&&(l.textContent="Time: "+d3.format("5.2f")(model.getTime()/1e3)+" (ps), "+"KE: "+d3.format("1.4f")(a)+", "+"PE: "+d3.format("1.4f")(b)+", "+"TE: "+d3.format("1.4f")(c)+", "+"Pressure: "+d3.format("6.3f")(model.pressure())+", "+"Rate: "+d3.format("5.1f")(model.get_rate())+" (steps/s)")};if(document.querySelectorAll){var m=document.querySelector("#fullscreen");m&&(m.style.cursor="pointer",m.addEventListener("click",function(){var a=document.documentElement,b=a.requestFullScreen||a.webkitRequestFullScreen||a.mozRequestFullScreen,c=document.fullScreen||document.webkitIsFullScreen||document.mozFullScreen,d=document.cancelFullScreen||document.webkitCancelFullScreen||document.mozCancelFullScreen;b?c?(layout.cancelFullScreen=!0,d.call(document)):(layout.cancelFullScreen=!1,b.call(a)):alert("You'll need to use a newer browser to use the\nfull-screen API.\n\nChrome v15 (beta)\nhttp://www.google.com/landing/chrome/beta/\n\nChrome v17 Canary:\nhttp://tools.google.com/dlpage/chromesxs\n\nSafari v5.1.1:\n\nFireFox v9 Aurora:\nhttps://www.mozilla.org/en-US/firefox/channel/\n\nFireFox v10 Nightly\nhttp://nightly.mozilla.org/\nOpen 'about:config' and set: full-screen-api-enabled")},!1))}layout.heatCoolButtons=function(a,b,c,d,e,f){var g=new ButtonComponent(a,"circlesmall-plus"),h=new ButtonComponent(b,"circlesmall-minus");g.add_action(function(){var c=e.get("temperature");c<d?($(a).removeClass("inactive"),$(b).removeClass("inactive"),c=Math.floor(c*2)/2+.5,e.set({temperature:c}),typeof f=="function"&&f(c)):$(a).addClass("inactive")}),h.add_action(function(){var d=e.get("temperature");d>c?($(a).removeClass("inactive"),$(b).removeClass("inactive"),d=Math.floor(d*2)/2-.5,e.set({temperature:d}),typeof f=="function"&&f(d)):$(b).addClass("inactive")})}})();