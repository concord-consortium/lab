(function(){typeof console=="undefined"&&(window.console={},console.log=console.info=console.warn=console.error=function(){}),grapher={version:"0.0.1"},grapher.data=function(a){var b=0,c=a.length,d=[];for(b=0;b<c;b+=2)d.push({x:a[b],y:a[b+1]});return d},grapher.indexedData=function(a,b){var c=0,d=b||0,e=a.length,f=[];for(c=0;c<e;c++)f.push({x:c+d,y:a[c]});return f},grapher.graph=function(a,b,c){function A(a){if(a)for(var b in z)a[b]===undefined&&(a[b]=z[b]);else a=z;return a}function B(a){if(a||!b)b=A(b);b.dataChange?u="ns-resize":u="crosshair",b.xrange=b.xmax-b.xmin,b.yrange=b.ymax-b.ymin,n={top:b.title?40:20,right:30,bottom:b.xlabel?60:10,left:b.ylabel?70:45},o={width:d-n.left-n.right,height:e-n.top-n.bottom},r=function(a){return a[0]},s=function(a){return a[1]},p=d3.scale.linear().domain([b.xmin,b.xmax]).range([0,o.width]),q=d3.scale.linear().domain([b.ymax,b.ymin]).nice().range([0,o.height]).nice(),t=d3.svg.line().x(function(a,b){return p(points[b][0])}).y(function(a,b){return q(points[b][1])})}function C(c){function k(a){a?m.text(a):m.text("")}function l(){var a=b.yrange/2,c=a/2,d;return b.datacount=o.width/30,b.xtic=b.xrange/b.datacount,b.ytic=b.yrange/b.datacount,d=d3.range(b.datacount).map(function(d){return[d*b.xtic+b.xmin,b.ymin+c+Math.random()*a]}),d}function r(){if(!y)return;switch(d3.event.keyCode){case 8:case 46:if(b.dataChange){var a=points.indexOf(y);points.splice(a,1),y=points.length?points[a>0?a-1:0]:null,E()}d3.event&&d3.event.keyCode&&(d3.event.preventDefault(),d3.event.stopPropagation())}}function s(){n={top:b.title?40:20,right:30,bottom:b.xlabel?60:10,left:b.ylabel?70:45},o.width=d-n.left-n.right,o.height=e-n.top-n.bottom,g.attr("width",o.width).attr("height",o.height)}function z(){p.domain([b.xmin,b.xmax]).range([0,o.width])}function A(){q.domain([b.ymin,b.ymax]).range([o.height,0])}function D(){var a=function(a){return"translate("+p(a)+",0)"},c=function(a){return"translate(0,"+q(a)+")"},d=function(a){return a?"#ccc":"#666"},e=p.tickFormat(b.datacount),h=p.tickFormat(b.datacount),i=f.selectAll("g.x").data(p.ticks(10),String).attr("transform",a);i.select("text").text(e);var j=i.enter().insert("g","a").attr("class","x").attr("transform",a);j.append("line").attr("stroke",d).attr("y1",0).attr("y2",o.height),j.append("text").attr("class","axis").attr("y",o.height).attr("dy","1em").attr("text-anchor","middle").text(e).style("cursor","ew-resize").on("mouseover",function(a){d3.select(this).style("font-weight","bold")}).on("mouseout",function(a){d3.select(this).style("font-weight","normal")}).on("mousedown.drag",G).on("touchstart.drag",G),i.exit().remove();var k=f.selectAll("g.y").data(q.ticks(10),String).attr("transform",c);k.select("text").text(h);var l=k.enter().insert("g","a").attr("class","y").attr("transform",c).attr("background-fill","#FFEEB6");l.append("line").attr("stroke",d).attr("x1",0).attr("x2",o.width),l.append("text").attr("class","axis").attr("x",-3).attr("dy",".35em").attr("text-anchor","end").text(h).style("cursor","ns-resize").on("mouseover",function(a){d3.select(this).style("font-weight","bold")}).on("mouseout",function(a){d3.select(this).style("font-weight","normal")}).on("mousedown.drag",H).on("touchstart.drag",H),k.exit().remove(),g.call(d3.behavior.zoom().x(p).y(q).on("zoom",D)),E()}function E(){var a=f.select("path").attr("d",t(points)),c=f.select("svg").selectAll("circle").data(points,function(a){return a});b.circleRadius&&c.enter().append("circle").attr("class",function(a){return a===y?"selected":null}).attr("cx",function(a){return p(a[0])}).attr("cy",function(a){return q(a[1])}).attr("r",b.circleRadius).style("cursor",u).on("mousedown.drag",I).on("touchstart.drag",I),c.attr("class",function(a){return a===y?"selected":null}).attr("cx",function(a){return p(a[0])}).attr("cy",function(a){return q(a[1])}),c.exit().remove(),d3.event&&d3.event.keyCode&&(d3.event.preventDefault(),d3.event.stopPropagation())}function F(){grapher.registerKeyboardHandler(r),d3.select("body").style("cursor","move");if(d3.event.altKey){if(b.dataChange){var a=d3.svg.mouse(f.node()),c=[];c[0]=p.invert(Math.max(0,Math.min(o.width,a[0]))),c[1]=q.invert(Math.max(0,Math.min(o.height,a[1]))),points.push(c),points.sort(function(a,b){return a[0]<b[0]?-1:a[0]>b[0]?1:0}),y=c,E()}d3.event.preventDefault(),d3.event.stopPropagation()}}function G(a){document.onselectstart=function(){return!1};var b=d3.svg.mouse(f[0][0]);v=p.invert(b[0])}function H(a){document.onselectstart=function(){return!1};var b=d3.svg.mouse(f[0][0]);w=q.invert(b[1])}function I(a){grapher.registerKeyboardHandler(r),document.onselectstart=function(){return!1},y=x=a,E()}function J(){var a=d3.svg.mouse(f[0][0]),c,d,e,g=d3.event.changedTouches;x&&b.dataChange&&(x[1]=q.invert(Math.max(0,Math.min(o.height,a[1]))),E());if(!isNaN(v)){d3.select("body").style("cursor","ew-resize");var h=p.invert(a[0]),i=p.domain()[0],j=p.domain()[1],k=j-i;h!==0&&(c=v/h,e=[i,i+k*c],p.domain(e),D()),d3.event.preventDefault(),d3.event.stopPropagation()}if(!isNaN(w)){d3.select("body").style("cursor","ns-resize");var l=q.invert(a[1]),m=q.domain()[1],n=q.domain()[0],r=n-m;l!==0&&(d=w/l,e=[n,n-r*d],q.domain(e),D()),d3.event.preventDefault(),d3.event.stopPropagation()}}function K(){document.onselectstart=function(){return!0},d3.select("body").style("cursor","auto"),d3.select("body").style("cursor","auto"),isNaN(v)||(D(),v=Math.NaN,d3.event.preventDefault(),d3.event.stopPropagation()),isNaN(w)||(D(),w=Math.NaN,d3.event.preventDefault(),d3.event.stopPropagation()),x&&(x=null)}c||(c=a),c.each(function(){this.clientWidth&&this.clientHeight&&(d=this.clientWidth,e=this.clientHeight,o.width=d-n.left-n.right,o.height=e-n.top-n.bottom),points=b.points||l(),z(),A(),f=d3.select(this).append("svg").attr("width",d).attr("height",e).append("g").attr("transform","translate("+n.left+","+n.top+")"),g=f.append("rect").attr("width",o.width).attr("height",o.height).style("fill","#EEEEEE").attr("pointer-events","all").on("mousedown.drag",F).on("touchstart.drag",F).call(d3.behavior.zoom().x(p).y(q).on("zoom",D)),f.append("svg").attr("top",0).attr("left",0).attr("width",o.width).attr("height",o.height).attr("viewBox","0 0 "+o.width+" "+o.height).attr("class","line").append("path").attr("class","line").attr("d",t(points)),b.title&&(h=f.append("text").attr("class","title").text(b.title).attr("x",o.width/2).attr("dy","-0.8em").style("text-anchor","middle")),b.xlabel&&(i=f.append("text").attr("class","axis").text(b.xlabel).attr("x",o.width/2).attr("y",o.height).attr("dy","2.4em").style("text-anchor","middle")),b.ylabel&&(j=f.append("g").append("text").attr("class","axis").text(b.ylabel).style("text-anchor","middle").attr("transform","translate(-40 "+o.height/2+") rotate(-90)")),d3.select(this).on("mousemove.drag",J).on("touchmove.drag",J).on("mouseup.drag",K).on("touchend.drag",K),D(),m=f.append("text").attr("class","graph-notification").text("").attr("x",o.width/2).attr("y",o.height/2).style("text-anchor","middle")}),C.elem=a,C.redraw=D,C.update=E,C.notify=k,C.initialize=B,C.updateXScale=z,C.updateYScale=A}function D(){b.title&&h&&h.text(b.title)}function E(){b.xlabel&&i&&i.text(b.xlabel)}function F(){b.ylabel&&j?j.text(b.ylabel):j.style("display","none")}function G(a){return p(a[0])}function H(a){return q(a[1])}function I(){redraw()}var d=600,e=300;arguments.length&&(a=d3.select(a),d=a.property("clientWidth"),e=a.property("clientHeight"));var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=Math.NaN,w=Math.NaN,x=null,y=null,z={xmax:60,xmin:0,ymax:40,ymin:0,title:"Simple Graph1",xlabel:"X Axis",ylabel:"Y Axis",circleRadius:10,dataChange:!0,points:!1,notification:!1};return B(b),C.options=function(a){return arguments.length?C:b},C.margin=function(a){return arguments.length?(margin=a,C):margin},C.xmin=function(a){return arguments.length?(b.xmin=a,b.xrange=b.xmax-b.xmin,C.updateXScale&&(C.updateXScale(),C.redraw()),C):b.xmin},C.xmax=function(a){return arguments.length?(b.xmax=a,b.xrange=b.xmax-b.xmin,C.updateXScale&&(C.updateXScale(),C.redraw()),C):b.xmax},C.ymin=function(a){return arguments.length?(b.ymin=a,b.yrange=b.ymax-b.ymin,C.updateYScale&&(C.updateYScale(),C.redraw()),C):b.ymin},C.ymax=function(a){return arguments.length?(b.ymax=a,b.yrange=b.ymax-b.ymin,C.updateYScale&&(C.updateYScale(),C.redraw()),C):b.ymax},C.xLabel=function(a){return arguments.length?(b.xlabel=a,E(),C):b.xlabel},C.yLabel=function(a){return arguments.length?(b.ylabel=a,F(),C):b.ylabel},C.title=function(a){return arguments.length?(b.title=a,D(),C):b.title},C.width=function(a){return arguments.length?(o.width=a,C):o.width},C.height=function(a){return arguments.length?(o.height=a,C):o.height},C.x=function(a){return arguments.length?(r=a,C):r},C.y=function(a){return arguments.length?(s=a,C):s},C.elem=function(b){return arguments.length?(a=d3.select(b),a.call(C),C):a},C.data=function(a){if(!arguments.length)return points;var b=p.domain(),c=b[1]-b[0],d=c*.8;return points=a,points.length>b[1]?(b[0]+=d,b[1]+=d,p.domain(b),C.redraw()):C.update(),C},C.add_data=function(a){if(!arguments.length)return points;var b=p.domain(),c=b[1]-b[0],d=c*.8,e;if(a instanceof Array&&a.length>0)if(a[0]instanceof Array)for(e=0;e<a.length;e++)points.push(a[e]);else{if(a.length!==2)throw new Error("invalid argument to graph.add_data() "+a+" length should === 2.");points.push(a)}return points[points.length-1][0]>b[1]?(b[0]+=d,b[1]+=d,p.domain(b),C.redraw()):C.update(),C},C.reset=function(a){return arguments.length?C.initialize(a):C.initialize(),C.redraw(),C},a&&(a.call(C),c&&C.notify(c)),C},grapher.realTimeGraph=function(a,b){function H(a,b,c){var d=0,e=b||0,f=a.length,g=[];c=c||1;for(d=0;d<f;d++)g.push({x:(d+e)*c,y:a[d]});return g}function I(){return B?B.length:!1}function J(a,c){e=a,f=c,d.style.width=e+"px",d.style.height=f+"px",g={top:b.title?40:20,right:35,bottom:b.xlabel?50:30,left:b.ylabel?60:35},width=e-g.left-g.right,height=f-g.top-g.bottom,h={width:width,height:height},i=h.width,j=h.height,l.domain([b.xmin,b.xmax]).range([0,h.width]),o.domain([b.ymin,b.ymax]).nice().range([h.height,0]).nice(),m=Math.NaN,p=Math.NaN,s=null}function K(){function a(){d3.event&&d3.event.transform&&isNaN(m)&&isNaN(p)&&d3.event.transform(x,y);var b=l.tickFormat(10),d=o.tickFormat(8),e=w.selectAll("g.x").data(l.ticks(8),String).attr("transform",n);e.select("text").text(b);var f=e.enter().insert("g","a").attr("class","x").attr("transform",n);f.append("line").attr("stroke",k).attr("y1",0).attr("y2",h.height),f.append("text").attr("y",h.height).attr("dy","1em").attr("text-anchor","middle").style("cursor","ew-resize").text(b).on("mouseover",function(a){d3.select(this).style("font-weight","bold")}).on("mouseout",function(a){d3.select(this).style("font-weight","normal")}).on("mousedown.drag",v).on("touchstart.drag",v),e.exit().remove();var g=w.selectAll("g.y").data(o.ticks(10),String).attr("transform",q);g.select("text").text(d);var i=g.enter().insert("g","a").attr("class","y").attr("transform",q).attr("background-fill","#FFEEB6");i.append("line").attr("stroke",k).attr("x1",0).attr("x2",h.width),i.append("text").attr("x",-3).attr("dy",".35em").attr("text-anchor","end").style("cursor","ns-resize").text(d).on("mouseover",function(a){d3.select(this).style("font-weight","bold")}).on("mouseout",function(a){d3.select(this).style("font-weight","normal")}).on("mousedown.drag",F).on("touchstart.drag",F),g.exit().remove(),z.call(d3.behavior.zoom().x(l).y(o).scaleExtent([1,8]).on("zoom",a)),c()}function c(){var a,b=d.children[0].getElementsByTagName("rect")[0];gcanvas.style.zIndex==="-100"&&w.select("path.line").attr("d",r(B)),V();if(K.selectable_points){var e=w.selectAll("circle").data(B,function(a){return a});e.enter().append("circle").attr("class",function(a){return a===t?"selected":null}).attr("cx",function(a){return x(a.x)}).attr("cy",function(a){return y(a.y)}).attr("r",1).on("mousedown",function(a){t=s=a,c()}),e.attr("class",function(a){return a===t?"selected":null}).attr("cx",function(a){return x(a.x)}).attr("cy",function(a){return y(a.y)}),e.exit().remove()}d3.event&&d3.event.keyCode&&(d3.event.preventDefault(),d3.event.stopPropagation())}function u(){z.style("cursor","move")}function v(a){document.onselectstart=function(){return!1};var b=d3.svg.mouse(w[0][0]);m=l.invert(b[0])}function F(a){document.onselectstart=function(){return!1};var b=d3.svg.mouse(w[0][0]);p=o.invert(b[1])}function G(){var b=d3.svg.mouse(w[0][0]),c,d,e,f=d3.event.changedTouches;document.onselectstart=function(){return!0};if(!isNaN(m)){var g=l.invert(b[0]),h=l.domain()[0],i=l.domain()[1],j=i-h;d3.select("body").style("cursor","ew-resize"),g!==0&&(c=m/g,e=[h,h+j*c],l.domain(e),a()),d3.event.preventDefault(),d3.event.stopPropagation()}if(!isNaN(p)){var k=o.invert(b[1]),n=o.domain()[1],q=o.domain()[0],r=q-n;d3.select("body").style("cursor","ns-resize"),k!==0&&(d=p/k,e=[q,q-r*d],o.domain(e),a()),d3.event.preventDefault(),d3.event.stopPropagation()}}function L(){d3.select("body").style("cursor","auto"),document.onselectstart=function(){return!0},isNaN(m)||(a(),m=Math.NaN,d3.event.preventDefault(),d3.event.stopPropagation()),isNaN(p)||(a(),p=Math.NaN,d3.event.preventDefault(),d3.event.stopPropagation()),s&&(s=null)}function M(a){C={x:B[a].x,y:B[a].y}}function N(a){if(B.length===0)return;C=!1;var b=B.length,d=b*E,e={x:d,y:a},f,g;B.push(e),c()}function O(a){if(B.length===0)return;C=!1;var b=B.length,c=b*E,d=c-E,e=l.call(self,d,d),f=o.call(self,B[b-1].y,b-1),g={x:c,y:a},h,i;B.push(g),h=l.call(self,c,c),i=o.call(self,a,c),gctx.beginPath(),gctx.moveTo(e,f),gctx.lineTo(h,i),gctx.stroke()}function P(a){B=H(a,0,E),c()}function Q(b){x=d3.scale.linear().domain([0,b]).range([0,i]),K.xmax=b,x_tics_scale=d3.scale.linear().domain([K.xmin*K.sample,K.xmax*K.sample]).range([0,i]),c(),a()}function R(b){y=d3.scale.linear().domain([b,0]).range([0,j]),K.ymax=b,c(),a()}function S(){gcanvas.width=gcanvas.width,gctx.fillStyle="rgba(0,255,0, 0.05)",gctx.fillRect(0,0,gcanvas.width,gcanvas.height),gctx.strokeStyle="rgba(255,65,0, 1.0)"}function T(){w.select("path.line").attr("d",[]),gcanvas.style.zIndex=100}function U(){gcanvas.style.zIndex=-100,c()}function V(){if(B.length===0)return;var a=l.call(self,0,0),b=o.call(self,B[0].y,0),c,d=0;S(),gctx.fillRect(0,0,gcanvas.width,gcanvas.height),gctx.beginPath(),gctx.moveTo(a,b);for(c=0;c<B.length-1;c++)d+=E,a=l.call(self,d,d),b=o.call(self,B[c].y,d),gctx.lineTo(a,b);gctx.stroke()}function W(){gcanvas=document.createElement("canvas"),d.appendChild(gcanvas),gcanvas.style.zIndex=-100,Y(gcanvas)}function X(){Y(gcanvas),V()}function Y(a){var b={};b.rect=d.children[0].getElementsByTagName("rect")[0],b.width=b.rect.width.baseVal.value,b.height=b.rect.height.baseVal.value,b.left=b.rect.getCTM().e,b.top=b.rect.getCTM().f,a.style.position="absolute",a.width=b.width,a.height=b.height,a.style.width=b.width+"px",a.style.height=b.height+"px",a.offsetLeft=b.left,a.offsetTop=b.top,a.style.left=b.left+"px",a.style.top=b.top+"px",a.style.border="solid 1px red",gctx=gcanvas.getContext("2d"),gctx.globalCompositeOperation="source-over",gctx.lineWidth=1,gctx.fillStyle="rgba(0,255,0, 0.05)",gctx.fillRect(0,0,a.width,gcanvas.height),gctx.strokeStyle="rgba(255,65,0, 1.0)",gcanvas.style.border="solid 1px red"}J(e,f),w===undefined?(w=d3.select(d).append("svg").attr("width",e).attr("height",f).append("g").attr("transform","translate("+g.left+","+g.top+")"),z=w.append("rect").attr("class","plot").attr("width",h.width).attr("height",h.height).style("fill","#EEEEEE").attr("pointer-events","all").on("mousedown",u).on("touchstart",u),z.call(d3.behavior.zoom().x(l).y(o).scaleExtent([1,8]).on("zoom",a)),A=w.append("svg").attr("class","viewbox").attr("top",0).attr("left",0).attr("width",h.width).attr("height",h.height).attr("viewBox","0 0 "+h.width+" "+h.height).append("path").attr("class","line").attr("d",r(B)),D=A.append("path").attr("class","marker").attr("d",[]),b.title&&w.append("text").attr("class","title").text(b.title).attr("x",h.width/2).attr("dy","-1em").style("text-anchor","middle"),b.xlabel&&w.append("text").attr("class","xlabel").text(b.xlabel).attr("x",h.width/2).attr("y",h.height).attr("dy","2.4em").style("text-anchor","middle"),b.ylabel&&w.append("g").append("text").attr("class","ylabel").text(b.ylabel).style("text-anchor","middle").attr("transform","translate(-40 "+h.height/2+") rotate(-90)"),W(),a()):(d3.select(d).select("svg").attr("width",e).attr("height",f),w.select("rect.plot").attr("width",h.width).attr("height",h.height).style("fill","#EEEEEE"),w.select("svg.viewbox").attr("top",0).attr("left",0).attr("width",h.width).attr("height",h.height).attr("viewBox","0 0 "+h.width+" "+h.height),b.title&&w.select("text.title").attr("x",h.width/2).attr("dy","-1em"),b.xlabel&&w.select("text.xlabel").attr("x",h.width/2).attr("y",h.height),b.ylabel&&w.select("text.ylabel").attr("transform","translate(-40 "+h.height/2+") rotate(-90)"),w.selectAll("g.x").remove(),w.selectAll("g.y").remove(),X(),a()),d3.select(this).on("mousemove.drag",G).on("touchmove.drag",G).on("mouseup.drag",L).on("touchend.drag",L),K.node=d,K.scale=J,K.update=c,K.redraw=a,K.number_of_points=I,K.new_data=P,K.add_point=N,K.add_canvas_point=O,K.initialize_canvas=W,K.show_canvas=T,K.hide_canvas=U,K.clear_canvas=S,K.update_canvas=V,K.showMarker=M,K.change_xaxis=Q,K.change_yaxis=R}var c=d3.select(a),d=c.node(),e=c.property("clientWidth"),f=c.property("clientHeight"),g,h,i,j,k=function(a){return a?"#ccc":"#666"},l=d3.scale.linear(),m,n=function(a){return"translate("+l(a)+",0)"},o=d3.scale.linear(),p,q=function(a){return"translate(0,"+o(a)+")"},r=d3.svg.line().x(function(a,b){return l(B[b].x)}).y(function(a,b){return o(B[b].y)}),s,t,u,v,w,z,A,B,C,D,E,F={title:"graph",xlabel:"x-axis",ylabel:"y-axis",xmax:10,xmin:0,ymax:10,ymin:0,dataset:[0],selectable_points:!0,circleRadius:!1,dataChange:!1,sample:1};if(b)for(var G in F)b[G]===undefined&&(b[G]=F[G]);else b=F;return E=b.sample,b.dataChange?circleCursorStyle="ns-resize":circleCursorStyle="crosshair",b.xrange=b.xmax-b.xmin,b.yrange=b.ymax-b.ymin,J(e,f),B=H(b.dataset,0),K.resize=function(a,b){K.scale(a,b),K()},d&&K(),K},grapher.colors=function(a){var b={bright_red:"#ff0000",dark_red:"#990000",bright_blue:"#4444ff",dark_blue:"#110077",bright_green:"#00dd00",dark_green:"#118800",bright_purple:"#cc00cc",dark_purple:"#770099",bright_orange:"#ee6600",dark_orange:"#aa4400",bright_turquoise:"#00ccbb",dark_turquoise:"#008877"};return b[a]},grapher.registerKeyboardHandler=function(a){d3.select(window).on("keydown",a)}})(),function(){typeof console=="undefined"&&(window.console={},console.log=console.info=console.warn=console.error=function(){});var a=function(b,c){var d=a.resolve(b,c||"/"),e=a.modules[d];if(!e)throw new Error("Failed to resolve module "+b+", tried "+d);var f=e._cached?e._cached:e();return f};a.paths=[],a.modules={},a.extensions=[".js",".coffee"],a._core={assert:!0,events:!0,fs:!0,path:!0,vm:!0},a.resolve=function(){return function(b,c){function h(b){if(a.modules[b])return b;for(var c=0;c<a.extensions.length;c++){var d=a.extensions[c];if(a.modules[b+d])return b+d}}function i(b){b=b.replace(/\/+$/,"");var c=b+"/package.json";if(a.modules[c]){var e=a.modules[c](),f=e.browserify;if(typeof f=="object"&&f.main){var g=h(d.resolve(b,f.main));if(g)return g}else if(typeof f=="string"){var g=h(d.resolve(b,f));if(g)return g}else if(e.main){var g=h(d.resolve(b,e.main));if(g)return g}}return h(b+"/index")}function j(a,b){var c=k(b);for(var d=0;d<c.length;d++){var e=c[d],f=h(e+"/"+a);if(f)return f;var g=i(e+"/"+a);if(g)return g}var f=h(a);if(f)return f}function k(a){var b;a==="/"?b=[""]:b=d.normalize(a).split("/");var c=[];for(var e=b.length-1;e>=0;e--){if(b[e]==="node_modules")continue;var f=b.slice(0,e+1).join("/")+"/node_modules";c.push(f)}return c}c||(c="/");if(a._core[b])return b;var d=a.modules.path();c=d.resolve("/",c);var e=c||"/";if(b.match(/^(?:\.\.?\/|\/)/)){var f=h(d.resolve(e,b))||i(d.resolve(e,b));if(f)return f}var g=j(b,e);if(g)return g;throw new Error("Cannot find module '"+b+"'")}}(),a.alias=function(b,c){var d=a.modules.path(),e=null;try{e=a.resolve(b+"/package.json","/")}catch(f){e=a.resolve(b,"/")}var g=d.dirname(e),h=(Object.keys||function(a){var b=[];for(var c in a)b.push(c);return b})(a.modules);for(var i=0;i<h.length;i++){var j=h[i];if(j.slice(0,g.length+1)===g+"/"){var k=j.slice(g.length);a.modules[c+k]=a.modules[g+k]}else j===g&&(a.modules[c]=a.modules[g])}},a.define=function(b,c){var d=a._core[b]?"":a.modules.path().dirname(b),e=function(b){return a(b,d)};e.resolve=function(b){return a.resolve(b,d)},e.modules=a.modules,e.define=a.define;var f={exports:{}};a.modules[b]=function(){return a.modules[b]._cached=f.exports,c.call(f.exports,e,f,f.exports,d,b),a.modules[b]._cached=f.exports,f.exports}},typeof process=="undefined"&&(process={}),process.nextTick||(process.nextTick=function(){var a=[],b=typeof window!="undefined"&&window.postMessage&&window.addEventListener;return b&&window.addEventListener("message",function(b){if(b.source===window&&b.data==="browserify-tick"){b.stopPropagation();if(a.length>0){var c=a.shift();c()}}},!0),function(c){b?(a.push(c),window.postMessage("browserify-tick","*")):setTimeout(c,0)}}()),process.title||(process.title="browser"),process.binding||(process.binding=function(b){if(b==="evals")return a("vm");throw new Error("No such module")}),process.cwd||(process.cwd=function(){return"."}),process.env||(process.env={}),process.argv||(process.argv=[]),a.define("path",function(a,b,c,d,e){function f(a,b){var c=[];for(var d=0;d<a.length;d++)b(a[d],d,a)&&c.push(a[d]);return c}function g(a,b){var c=0;for(var d=a.length;d>=0;d--){var e=a[d];e=="."?a.splice(d,1):e===".."?(a.splice(d,1),c++):c&&(a.splice(d,1),c--)}if(b)for(;c--;c)a.unshift("..");return a}var h=/^(.+\/(?!$)|\/)?((?:.+?)?(\.[^.]*)?)$/;c.resolve=function(){var a="",b=!1;for(var c=arguments.length;c>=-1&&!b;c--){var d=c>=0?arguments[c]:process.cwd();if(typeof d!="string"||!d)continue;a=d+"/"+a,b=d.charAt(0)==="/"}return a=g(f(a.split("/"),function(a){return!!a}),!b).join("/"),(b?"/":"")+a||"."},c.normalize=function(a){var b=a.charAt(0)==="/",c=a.slice(-1)==="/";return a=g(f(a.split("/"),function(a){return!!a}),!b).join("/"),!a&&!b&&(a="."),a&&c&&(a+="/"),(b?"/":"")+a},c.join=function(){var a=Array.prototype.slice.call(arguments,0);return c.normalize(f(a,function(a,b){return a&&typeof a=="string"}).join("/"))},c.dirname=function(a){var b=h.exec(a)[1]||"",c=!1;return b?b.length===1||c&&b.length<=3&&b.charAt(1)===":"?b:b.substring(0,b.length-1):"."},c.basename=function(a,b){var c=h.exec(a)[2]||"";return b&&c.substr(-1*b.length)===b&&(c=c.substr(0,c.length-b.length)),c},c.extname=function(a){return h.exec(a)[3]||""}}),a.define("/arrays/arrays.js",function(a,b,c,d,e){var f;f=c.arrays={},f.version="0.0.1",f.webgl=typeof window!="undefined"&&!!window.WebGLRenderingContext,f.typed=!1;try{var g=new Float64Array(0);f.typed=!0}catch(h){}f.create=function(a,b,c){c||(f.webgl||f.typed?c="Float32Array":c="regular"),b=b||0;var d,e;if(c==="regular")d=new Array(a);else switch(c){case"Float64Array":d=new Float64Array(a);break;case"Float32Array":d=new Float32Array(a);break;case"Int32Array":d=new Int32Array(a);break;case"Int16Array":d=new Int16Array(a);break;case"Int8Array":d=new Int8Array(a);break;case"Uint32Array":d=new Uint32Array(a);break;case"Uint16Array":d=new Uint16Array(a);break;case"Uint8Array":d=new Uint8Array(a);break;default:d=new Array(a)}e=-1;while(++e<a)d[e]=b;return d},f.constructor_function=function(a){if(a.buffer&&a.buffer.__proto__.constructor)return a.__proto__.constructor;if(a.constructor===Array)return a.constructor;throw new Error("arrays.constructor_function: must be an Array or Typed Array:   source: "+a+", source.constructor: "+a.constructor+", source.buffer: "+a.buffer+", source.buffer.slice: "+a.buffer.slice+", source.buffer.__proto__: "+a.buffer.__proto__+", source.buffer.__proto__.constructor: "+a.buffer.__proto__.constructor)},f.copy=function(a,b){var c=a.length,d=-1;while(++d<c)b[d]=a[d];return b.length=c,b},f.clone=function(a){var b,c=a.length,d,e;e=f.constructor_function(a);if(e===Array){d=new e(c);for(b=0;b<c;b++)d[b]=a[b];return d}if(a.buffer.slice)return d=new e(a.buffer.slice(0)),d;d=new e(c);for(b=0;b<c;b++)d[b]=a[b];return d},f.between=function(a,b,c){return c<Math.max(a,b)&&c>Math.min(a,b)},f.max=function(a){return Math.max.apply(Math,a)},f.min=function(a){return Math.min.apply(Math,a)},f.maxTypedArray=function(a){var b,c,d=Number.MIN_VALUE,e=a.length;for(c=0;c<e;c++)b=a[c],d=b>d?b:d;return d},f.minTypedArray=function(a){var b,c,d=Number.MAX_VALUE,e=a.length;for(c=0;c<e;c++)b=a[c],d=b<d?b:d;return d},f.maxAnyArray=function(a){try{return Math.max.apply(Math,a)}catch(b){if(b instanceof TypeError){var c,d,e=Number.MIN_VALUE,f=a.length;for(d=0;d<f;d++)c=a[d],e=c>e?c:e;return e}}},f.minAnyArray=function(a){try{return Math.min.apply(Math,a)}catch(b){if(b instanceof TypeError){var c,d,e=Number.MAX_VALUE,f=a.length;for(d=0;d<f;d++)c=a[d],e=c<e?c:e;return e}}},f.average=function(a){var b,c=0,d=a.length;for(b=0;b<d;b++)c+=a[b];return c/d}}),a.define("/constants/index.js",function(a,b,c,d,e){var f=a("./units"),g=f.unit,h=f.ratio,i=f.convert,j={ELEMENTARY_CHARGE:{value:1,unit:g.ELEMENTARY_CHARGE},ATOMIC_MASS:{value:1,unit:g.DALTON},BOLTZMANN_CONSTANT:{value:1.380658e-23,unit:g.JOULES_PER_KELVIN},AVAGADRO_CONSTANT:{value:h(g.DALTON,{per:g.GRAM}),unit:g.INVERSE_MOLE},PERMITTIVITY_OF_FREE_SPACE:{value:8.854187e-12,unit:g.FARADS_PER_METER}},k,l;j.COULOMB_CONSTANT={value:1/(4*Math.PI*j.PERMITTIVITY_OF_FREE_SPACE.value),unit:g.METERS_PER_FARAD},c.unit=g,c.ratio=h,c.convert=i;for(k in j)j.hasOwnProperty(k)&&(l=j[k],c[k]=function(a){return{as:function(b){return f.convert(a.value,{from:a.unit,to:b})}}}(l))}),a.define("/constants/units.js",function(a,b,c,d,e){var f=1.66054e-27,g=1.602177e-19,h=g,i=1e-15,j=1e-9,k=10,l=1e3,m={TIME:"time",LENGTH:"length",MASS:"mass",ENERGY:"energy",ENTROPY:"entropy",CHARGE:"charge",INVERSE_QUANTITY:"inverse quantity",FARADS_PER_METER:"farads per meter",METERS_PER_FARAD:"meters per farad",FORCE:"force",VELOCITY:"velocity",AREA:"area",PRESSURE:"pressure"},n,o,p;c.unit=n={FEMTOSECOND:{name:"femtosecond",value:1,type:m.TIME},SECOND:{name:"second",value:i,type:m.TIME},NANOMETER:{name:"nanometer",value:1,type:m.LENGTH},ANGSTROM:{name:"Angstrom",value:1*k,type:m.LENGTH},METER:{name:"meter",value:1*j,type:m.LENGTH},DALTON:{name:"Dalton",value:1,type:m.MASS},GRAM:{name:"gram",value:1*f*l,type:m.MASS},KILOGRAM:{name:"kilogram",value:1*f,type:m.MASS},MW_ENERGY_UNIT:{name:"MW Energy Unit (Dalton * nm^2 / fs^2)",value:1,type:m.ENERGY},JOULE:{name:"Joule",value:f*j*j*(1/i)*(1/i),type:m.ENERGY},EV:{name:"electron volt",value:f*j*j*(1/i)*(1/i)*(1/h),type:m.ENERGY},EV_PER_KELVIN:{name:"electron volts per Kelvin",value:1,type:m.ENTROPY},JOULES_PER_KELVIN:{name:"Joules per Kelvin",value:1*h,type:m.ENTROPY},ELEMENTARY_CHARGE:{name:"elementary charge",value:1,type:m.CHARGE},COULOMB:{name:"Coulomb",value:g,type:m.CHARGE},INVERSE_MOLE:{name:"inverse moles",value:1,type:m.INVERSE_QUANTITY},FARADS_PER_METER:{name:"Farads per meter",value:1,type:m.FARADS_PER_METER},METERS_PER_FARAD:{name:"meters per Farad",value:1,type:m.METERS_PER_FARAD},MW_FORCE_UNIT:{name:"MW force units (Dalton * nm / fs^2)",value:1,type:m.FORCE},NEWTON:{name:"Newton",value:1*f*j*(1/i)*(1/i),type:m.FORCE},MW_VELOCITY_UNIT:{name:"MW velocity units (nm / fs)",value:1,type:m.VELOCITY},METERS_PER_SECOND:{name:"meters per second",value:1*j*(1/i),type:m.VELOCITY}},c.ratio=o=function(a,b){var c=function(a,b){if(a.type!==b.type)throw new Error("Attempt to convert incompatible type '"+a.name+"'' to '"+b.name+"'")};if(b.per)return c(a,b.per),a.value/b.per.value;if(b.as)return c(a,b.as),b.as.value/a.value;throw new Error("units.ratio() received arguments it couldn't understand.")},c.convert=p=function(a,b){var c=b&&b.from,d=b&&b.to;if(!c)throw new Error('units.convert() did not receive a "from" argument');if(!d)throw new Error('units.convert() did not receive a "to" argument');return a*o(d,{per:c})}}),a.define("/math/index.js",function(a,b,c,d,e){c.normal=a("./distributions").normal,c.getWindowedAverager=a("./utils").getWindowedAverager}),a.define("/math/distributions.js",function(a,b,c,d,e){c.normal=function(){var a=null;return function(b,c){b==null&&(b=0),c==null&&(c=1);var d,e,f,g,h;return a?(e=a,a=null,e):(g=Math.random(),h=Math.random(),f=2*Math.PI*g,d=Math.sqrt(-2*Math.log(h)),a=b+c*d*Math.sin(f),b+c*d*Math.cos(f))}}()}),a.define("/math/utils.js",function(a,b,c,d,e){c.getWindowedAverager=function(a){a==null&&(a=1e3);var b=0,c=[],d=0;return function(e){return d-=c[b]||0,d+=e,c[b]=e,++b===a&&(b=0),c.length===a?d/a:NaN}}}),a.define("/potentials/index.js",function(a,b,c,d,e){var f=c.potentials={};c.coulomb=a("./coulomb"),c.makeLennardJonesCalculator=a("./lennard-jones").makeLennardJonesCalculator}),a.define("/potentials/coulomb.js",function(a,b,c,d,e){var f=a("../constants"),g=f.unit,h=f.COULOMB_CONSTANT.as(f.unit.METERS_PER_FARAD),i=f.ratio(g.NANOMETER,{per:g.METER}),j=Math.pow(f.ratio(g.COULOMB,{per:g.ELEMENTARY_CHARGE}),2),k=f.ratio(g.EV,{per:g.JOULE}),l=f.ratio(g.MW_FORCE_UNIT,{per:g.NEWTON}),m=h*j*i*k,n=h*j*i*i*l,o=c.potential=function(a,b,c){return m*(b*c/a)},p=c.forceFromSquaredDistance=function(a,b,c){return-n*(b*c/a)},q=c.forceOverDistanceFromSquaredDistance=function(a,b,c){return p(a,b,c)/Math.sqrt(a)},r=c.force=function(a,b,c){return p(a*a,b,c)}}),a.define("/potentials/lennard-jones.js",function(a,b,c,d,e){var f=a("../constants"),g=f.unit,h=f.ratio(g.NANOMETER,{per:g.METER}),i=f.ratio(g.MW_FORCE_UNIT,{per:g.NEWTON});c.makeLennardJonesCalculator=function(a,b){var c=[],d=[],e=[],j=[],k=[],l=[],m=[],n=[],o=function(a){var o,q,r,s,t,u,v,w,x,y,z,A;for(o=0,q=a.length;o<q;o++){c[o]=[],d[o]=[],e[o]=[],j[o]=[],k[o]=[],l[o]=[],m[o]=[],n[o]=[];for(r=0;r<o+1;r++)t=(a[o][1]+a[r][1])/2,u=Math.sqrt(a[o][2]*a[r][2]),v=Math.pow(2,1/6)*u,A=v*5,t!=null&&u!=null&&(w=4*t*Math.pow(u,12),x=4*t*Math.pow(u,6),y=12*f.convert(w,{from:g.EV,to:g.JOULE})*h*i,z=6*f.convert(x,{from:g.EV,to:g.JOULE})*h*i),c[o][r]=c[r][o]=t,d[o][r]=d[r][o]=u,e[o][r]=e[r][o]=v,j[o][r]=j[r][o]=w,k[o][r]=k[r][o]=x,l[o][r]=l[r][o]=y,m[o][r]=m[r][o]=z,n[o][r]=n[r][o]=A*A}typeof b=="function"&&b(p(),this)},p=function(){return{epsilon:c,sigma:d,rmin:e,cutoffDistanceSq:n}},q=function(a){if(a==null||parseFloat(a)!==a)throw new Error("lennardJones: epsilon value "+a+" is invalid")},r=function(a){if(a==null||parseFloat(a)!==a||a<=0)throw new Error("lennardJones: sigma value "+a+" is invalid")},s;return o(a),s={coefficients:p,potentialFromSquaredDistance:function(a,b,c){return j[b][c]*Math.pow(a,-6)-k[b][c]*Math.pow(a,-3)},potential:function(a,b,c){return s.potentialFromSquaredDistance(a*a,b,c)},forceOverDistanceFromSquaredDistance:function(a,b,c){var d=1/a,e=d*d*d,f=e*d,g=f*e;return l[b][c]*g-m[b][c]*f},force:function(a,b,c){return a*s.forceOverDistanceFromSquaredDistance(a*a,b,c)}}}}),a.define("/md2d.js",function(a,b,c,d,e){typeof window=="undefined"&&(window={});var f=a("./arrays/arrays").arrays,g=a("./constants"),h=g.unit,i=a("./math"),j=a("./potentials").coulomb,k=a("./potentials").makeLennardJonesCalculator,l=!0,m=function(){try{new Float32Array}catch(a){return!1}return!0}(),n=2,o=1e3,p=-120*g.BOLTZMANN_CONSTANT.as(h.EV_PER_KELVIN),q=.34,r=39.95,s=g.convert(r,{from:h.DALTON,to:h.KILOGRAM}),t=g.BOLTZMANN_CONSTANT.as(h.JOULES_PER_KELVIN),u,v,w,x=function(a,b,c,d){return a*d-b*c},y=function(a,b){return a*a+b*b},z=function(){},A=function(a,b){var c=2*b,d=2/c*a,e=g.convert(d,{from:h.MW_ENERGY_UNIT,to:h.JOULE});return e/t},B=function(a,b){var c=2*b,d=a*t,e=g.convert(d,{from:h.JOULE,to:h.MW_ENERGY_UNIT}),f=e*c/2;return f},C=function(a){var b=parseFloat(a);if(isNaN(b))throw new Error("md2d: requested temperature "+a+" could not be understood.");if(b<0)throw new Error("md2d: requested temperature "+b+" was less than zero");if(b===Infinity)throw new Error("md2d: requested temperature was Infinity!")},D=function(a){var b=[];for(var c=0,d=a.length;c<d;c++)b[c]=a[c];return b};c.INDICES=v={RADIUS:0,PX:1,PY:2,X:3,Y:4,VX:5,VY:6,SPEED:7,AX:8,AY:9,CHARGE:10,ELEMENT:11},c.SAVEABLE_INDICES=w=["X","Y","VX","VY","CHARGE","ELEMENT"],c.NODE_PROPERTIES_COUNT=u=12,c.makeModel=function(){var a,b=!1,c=!1,d=!1,e=!0,p=!1,q=!1,r,s=.001,t=[10,10],z,B,E,F,G=0,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,ba,bb,bc,bd,be,bf,bg,bh=window.state={},bi=[],bj=function(a){bi=a.cutoffDistanceSq,M&&X&&bk()},bk=function(){var a=bl.coefficients().sigma,b,c;for(b=0,c=M.length;b<c;b++)M[b]=.5*a[X[b]][X[b]]},bl,bm,bn=function(){return d?1e3:1e3},bo=function(){q=!0,bm=i.getWindowedAverager(bn())},bp=function(){var a=0,b;for(b=0;b<J;b++)a+=L[X[b]][0]*(R[b]*R[b]+S[b]*S[b]);return A(a/2,J)},bq=function(a,b){R[a]*=b,S[a]*=b,N[a]*=b,O[a]*=b},br=function(a,b,c){R[a]+=b,S[a]+=c,N[a]+=L[X[a]][0]*b,O[a]+=
L[X[a]][0]*c},bs=function(a,b){R[a]-=b*(Q[a]-$),S[a]+=b*(P[a]-Z)},bt=function(){for(var a=0;a<J;a++)br(a,-bb,-bc),bs(a,-bf)},bu=function(){for(var a=0;a<J;a++)br(a,bb,bc),bs(a,bf)},bv=function(){var a=0,b=0,c=0,d=0,e;for(e=0;e<J;e++)a+=P[e],b+=Q[e],c+=N[e],d+=O[e];Z=a/J,$=b/J,_=c,ba=d,bb=c/K,bc=d/K},bw=function(){var a=0,b=0,c,d;for(d=0;d<J;d++)c=L[X[d]][0],a+=c*x(P[d]-Z,Q[d]-$,R[d]-bb,S[d]-bc),b+=c*y(P[d]-Z,Q[d]-$);bd=a,be=b,bf=bd/be},bx=function(){bv(),bw()},by=function(a){P[a]+=R[a]*H+.5*U[a]*I,Q[a]+=S[a]*H+.5*V[a]*I},bz=function(a){P[a]<F?(P[a]=F+(F-P[a]),R[a]*=-1):P[a]>B&&(P[a]=B-(P[a]-B),R[a]*=-1),Q[a]<E?(Q[a]=E+(E-Q[a]),S[a]*=-1):Q[a]>z&&(Q[a]=z-(Q[a]-z),S[a]*=-1)},bA=function(a){var b=L[X[a]][0];R[a]+=.5*U[a]*H,N[a]=b*R[a],S[a]+=.5*V[a]*H,O[a]=b*S[a]},bB=function(a){var b,c,f,g,h,i,k,l=X[a],m,n=1/L[l][0],o,p=W[a];for(b=0;b<a;b++)m=X[b],o=1/L[m][0],c=P[b]-P[a],f=Q[b]-Q[a],g=c*c+f*f,h=0,e&&g<bi[l][m]&&(h+=bl.forceOverDistanceFromSquaredDistance(g,l,m)),d&&(h+=j.forceOverDistanceFromSquaredDistance(g,p,W[b])),h&&(i=h*c,k=h*f,U[a]+=i*n,V[a]+=k*n,U[b]-=i*o,V[b]-=k*o)},bC=function(a,b){var c,d;a==null&&(a=r),bg=bp(),q&&Math.abs(bm(bg)-a)<=a*s&&(q=!1);if(b||p||q&&bg>0){c=Math.sqrt(a/bg);for(d=0;d<J;d++)bq(d,c);bg=a}};return a={outputState:bh,useCoulombInteraction:function(a){d=!!a},useLennardJonesInteraction:function(a){e=!!a},useThermostat:function(a){p=!!a},setTargetTemperature:function(a){C(a),r=a},setTime:function(a){bh.time=G=a},setSize:function(a){if(b)throw new Error("The molecular model's size has already been set, and cannot be reset.");var c=a[0]&&a[0]>0?a[0]:10,d=a[1]&&a[1]>0?a[1]:10;t=[c,d]},getSize:function(){return[t[0],t[1]]},getLJCalculator:function(){return bl},setElements:function(a){if(c)throw new Error("md2d: setElements cannot be called after atoms have been created");L=a,bl=window.lennardJones=k(L,bj)},createAtoms:function(d){var e=m&&l?"Float32Array":"regular",g=m&&l?"Uint8Array":"regular",h;if(c)throw new Error("md2d: createAtoms was called even though the particles have already been created for this model instance.");c=!0,b=!0;if(typeof d=="undefined")throw new Error("md2d: createAtoms was called without options specifying the atoms to create.");J=d.X&&d.Y?d.X.length:d.num;if(typeof J=="undefined")throw new Error("md2d: createAtoms was called without the required 'N' option specifying the number of atoms to create.");if(J!==Math.floor(J))throw new Error("md2d: createAtoms was passed a non-integral 'N' option.");if(J<n)throw new Error("md2d: create Atoms was passed an 'N' option equal to: "+J+" which is less than the minimum allowable value: N_MIN = "+n+".");if(J>o)throw new Error("md2d: create Atoms was passed an 'N' option equal to: "+J+" which is greater than the minimum allowable value: N_MAX = "+o+".");Y=a.nodes=f.create(u,null,"regular"),M=a.radius=Y[v.RADIUS]=f.create(J,0,e),N=a.px=Y[v.PX]=f.create(J,0,e),O=a.py=Y[v.PY]=f.create(J,0,e),P=a.x=Y[v.X]=f.create(J,0,e),Q=a.y=Y[v.Y]=f.create(J,0,e),R=a.vx=Y[v.VX]=f.create(J,0,e),S=a.vy=Y[v.VY]=f.create(J,0,e),T=a.speed=Y[v.SPEED]=f.create(J,0,e),U=a.ax=Y[v.AX]=f.create(J,0,e),V=a.ay=Y[v.AY]=f.create(J,0,e),W=a.charge=Y[v.CHARGE]=f.create(J,0,e),X=a.element=Y[v.ELEMENT]=f.create(J,0,g)},initializeAtomsFromProperties:function(b){var c=0,d,e;if(!b.X||!b.Y)throw new Error("md2d: initializeAtomsFromProperties must specify at minimum X and Y locations.");if(!b.VX||!b.VY)throw new Error("md2d: For now, velocities must be set when locations are set.");for(d=0,e=J;d<e;d++)P[d]=b.X[d],Q[d]=b.Y[d],R[d]=b.VX[d],S[d]=b.VY[d],T[d]=Math.sqrt(R[d]*R[d]+S[d]*S[d]);if(b.CHARGE)for(d=0,e=J;d<e;d++)W[d]=b.CHARGE[d];if(b.ELEMENT)for(d=0,e=J;d<e;d++)X[d]=b.ELEMENT[d],c+=L[X[d]][0];else c=J*L[0][0];K=a.totalMass=c,bk(),bg=bp(),a.computeOutputState()},initializeAtomsRandomly:function(b){var c=b.temperature||100,d=Math.floor(Math.sqrt(J)),e=Math.ceil(J/d),f,g,h,j,k,l,m,n=bl.coefficients();C(c),k=t[0]/(1+e),j=t[1]/(1+d),f=-1,K=0;for(g=1;g<=d;g++)for(h=1;h<=e;h++){f++;if(f===J)break;P[f]=h*k,Q[f]=g*j,l=i.normal(1,.25),m=2*Math.random()*Math.PI,R[f]=l*Math.cos(m),N[f]=L[X[f]][0]*R[f],S[f]=l*Math.sin(m),O[f]=L[X[f]][0]*S[f],U[f]=0,V[f]=0,T[f]=Math.sqrt(R[f]*R[f]+S[f]*S[f]),W[f]=2*(f%2)-1,X[f]=Math.floor(Math.random()*L.length),M[f]=n.rmin[X[f]][X[f]]/2,a.totalMass=K+=L[X[f]][0]}bx(),bt(),bC(c,!0),bg=bp(),a.computeOutputState()},relaxToTemperature:function(b){b!=null&&(r=b),C(r),bo();while(q)a.integrate()},integrate:function(b,d){if(!c)throw new Error("md2d: integrate called before atoms created.");b==null&&(b=100),H=d||1,I=H*H,F=M[0],E=M[0],B=t[0]-M[0],z=t[1]-M[0];var e=G,f=Math.floor(b/H),g,h;for(g=1;g<=f;g++){G=e+g*H;for(h=0;h<J;h++)by(h),bz(h),bA(h),U[h]=V[h]=0,bB(h);for(h=0;h<J;h++)bA(h),T[h]=Math.sqrt(R[h]*R[h]+S[h]*S[h]);bC()}a.computeOutputState()},computeOutputState:function(){var a,b,c,f,i,k,l;l=0,k=0;for(a=0;a<J;a++){k+=.5*L[X[a]][0]*(R[a]*R[a]+S[a]*S[a]);for(b=a+1;b<J;b++)c=P[b]-P[a],f=Q[b]-Q[a],i=c*c+f*f,e&&(l+=-bl.potentialFromSquaredDistance(i,X[a],X[b])),d&&(l+=-j.potential(Math.sqrt(i),W[a],W[b]))}bh.time=G,bh.pressure=0,bh.PE=l,bh.KE=g.convert(k,{from:h.MW_ENERGY_UNIT,to:h.EV}),bh.T=bg,bh.pCM=[_,ba],bh.CM=[Z,$],bh.vCM=[bb,bc],bh.omega_CM=bf},serialize:function(){var a={},b,c,d,e;for(d=0,e=w.length;d<e;d++)b=w[d],c=Y[v[b]],a[b]=c.slice?c.slice():D(c);return a}}}}),a("/md2d.js");var b=a("./md2d"),c;modeler={},modeler.VERSION="0.2.0",modeler.model=function(a){function T(a){$.unique(a);for(var b=0,c=a.length;b<c;b++)a[b]()}function U(a){var b,c,d=[],e,f;typeof a=="string"?c=[a]:c=a;for(e=0,f=c.length;e<f;e++)b=c[e],R[b]&&(d=d.concat(R[b]));R.all&&(d=d.concat(R.all)),T(d)}function V(){var a,b=0,c=Q[0].length;a=-1;while(++a<c)b+=I[a];return b/c}function W(){return m===0}function X(){var a,b=[],c=P;a=-1;while(++a<c)b[a]=arrays.clone(Q[a]);l.length=m,m++,n++,o=!0,l.push({nodes:b,pressure:z.pressure,pe:z.PE,ke:z.KE,time:z.time}),m>1e3&&(l.splice(0,1),m=1e3)}function Y(){var a;return W()&&X(),c.integrate(),r=z.pressure,x=z.PE,y=z.KE,w=z.time,s.push(r),s.splice(0,s.length-16),X(),k?A&&A():(a=Date.now(),t?(t=a-t,t&&u.push(t),t=a,u.splice(0,u.length-128)):t=a,g.tick({type:"tick"})),k}function Z(){l=[],m=0,n=-1}function _(){l.length=m+1}function ba(a){var b,d=P;if(a<0)throw new Error("modeler: request for tick_history_list["+a+"]");if(a>=l.length)throw new Error("modeler: request for tick_history_list["+a+"], tick_history_list.length="+l.length);b=-1;while(++b<d)arrays.copy(l[a].nodes[b],Q[b]);y=l[a].ke,w=l[a].time,c.setTime(w)}function bb(){return s.reduce(function(a,b){return a+b})/s.length}function bc(a){if(!arguments.length)return bc.reduce(function(a,b){return a+b})/s.length;bc.push(a),bc.splice(0,bc.length-100)}function bd(){var a,b,c=0,d=u.length;a=-1;while(++a<d)c+=u[a];return b=c/d,b?1/b*1e3:0}function be(a){v=a,c.setTargetTemperature(a)}function bf(a){var b,c=[];for(b in a)a.hasOwnProperty(b)&&a[b]!==undefined&&a[b]!==null&&(S["set_"+b]?S["set_"+b](a[b]):S[b]&&(S[b]=a[b]),c.push(b));U(c)}function bg(a){var d,g,i,j,k;c=b.makeModel(),c.setSize([N,O]);if(e){g=[];for(j=0,k=e.length;j<k;j++)i=e[j],g[i.id]=[i.mass,i.epsilon,i.sigma];c.setElements(g)}return typeof a=="number"?c.createAtoms({num:a}):c.createAtoms(a),Q=c.nodes,B=c.radius,C=c.px,D=c.py,E=c.x,F=c.y,G=c.vx,H=c.vy,I=c.speed,J=c.ax,K=c.ay,L=c.mass,M=c.charge,z=c.outputState,f.length=Q[0].length,h=S.temperature_control,v=S.temperature,Z(),o=!0,c.useLennardJonesInteraction(S.lennard_jones_forces),c.useCoulombInteraction(S.coulomb_forces),c.useThermostat(S.temperature_control),d=v,c.setTargetTemperature(d),a.X&&a.Y?c.initializeAtomsFromProperties(a):c.initializeAtomsRandomly({temperature:d}),c}var d={},e=a.elements||[{id:0,mass:39.95,epsilon:-0.1,sigma:.34}],f=[],g=d3.dispatch("tick","play","stop","reset","stepForward","stepBack","seek"),h,i,j,k=!0,l=[],m=0,n=0,o=!1,p,q,r,s=[0],t,u=[],v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N=a.width,O=a.height,P=12,Q,R={},S={temperature:300,coulomb_forces:!1,lennard_jones_forces:!0,temperature_control:!0,set_temperature:function(a){this.temperature=a,c&&c.setTargetTemperature(a)},set_temperature_control:function(a){this.temperature_control=a,c&&c.useThermostat(a)},set_coulomb_forces:function(a){this.coulomb_forces=a,c&&c.useCoulombInteraction(a)},set_epsilon:function(a){console.log("set_epsilon: This method is temporarily deprecated")},set_sigma:function(a){console.log("set_sigma: This method is temporarily deprecated")}};return d.INDICES={RADIUS:b.INDICES.RADIUS,PX:b.INDICES.PX,PY:b.INDICES.PY,X:b.INDICES.X,Y:b.INDICES.Y,VX:b.INDICES.VX,VY:b.INDICES.VY,SPEED:b.INDICES.SPEED,AX:b.INDICES.AX,AY:b.INDICES.AY,CHARGE:b.INDICES.CHARGE,ELEMENT:b.INDICES.ELEMENT},A=a.model_listener,bf(a),d.getStats=function(){return{speed:V(),ke:y,temperature:v,pressure:bb(),current_step:n,steps:l.length-1}},d.getStatsHistory=function(){var a,b,c,d=[];d.push("time (fs)\ttotal PE (eV)\ttotal KE (eV)\ttotal energy (eV)");for(a=0,b=l.length;a<b;a++)c=l[a],d.push(c.time+"\t"+c.pe+"\t"+c.ke+"\t"+(c.pe+c.ke));return d.join("\n")},d.stepCounter=function(){return n},d.steps=function(){return W()?0:l.length-1},d.isNewStep=function(){return o},d.seek=function(a){return arguments.length||(a=0),k=!0,o=!1,m=a,n=a,ba(m),g.seek(),U("seek"),n},d.stepBack=function(a){arguments.length||(a=1);var b=-1;k=!0,o=!1;while(++b<a)m>1&&(m--,n--,ba(m-1),A&&A());return n},d.stepForward=function(a){arguments.length||(a=1);var b=-1;k=!0;while(++b<a)m<l.length?(ba(m),m++,n++,A&&A()):Y();return n},d.setEpsilon=function(a){c.setLJEpsilon(a)},d.setSigma=function(a){c.setLJSigma(a)},d.getEpsilon=function(){return c.getLJEpsilon()},d.getSigma=function(){return c.getLJSigma()},d.getLJCalculator=function(){return c.getLJCalculator()},d.resetTime=function(){c.setTime(0)},d.getTime=function(){return z?z.time:undefined},d.set_radius=function(a){},d.get_speed=function(){return arrays.copy(I,[])},d.get_rate=function(){return bd()},d.is_stopped=function(){return k},d.set_lennard_jones_forces=function(a){i=a,c.useLennardJonesInteraction(a)},d.set_coulomb_forces=function(a){j=a,c.useCoulombInteraction(a)},d.get_nodes=function(){return Q},d.get_atoms=function(){return f},d.on=function(a,b){return g.on(a,b),d},d.tickInPlace=function(){return g.tick({type:"tick"}),d},d.tick=function(a){arguments.length||(a=1);var b=-1;while(++b<a)Y();return d},d.relax=function(){return c.relaxToTemperature(),d},d.start=function(){return d.resume()},d.resume=function(){return k=!1,d3.timer(Y),g.play(),U("play"),d},d.stop=function(){return k=!0,g.stop(),d},d.ke=function(){return z?z.KE:undefined},d.ave_ke=function(){return z?z.KE/Q[0].length:undefined},d.pe=function(){return z?z.PE:undefined},d.ave_pe=function(){return z?z.PE/Q[0].length:undefined},d.speed=function(){return V()},d.pressure=function(){return bb()},d.temperature=function(a){return arguments.length?(be(a),d):v},d.size=function(a){return arguments.length?(c.setSize(a),d):c.getSize()},d.createNewAtoms=function(a){return bg(a)},d.set=function(a){bf(a)},d.get=function(a){return S[a]},d.addPropertiesListener=function(a,b){var c,d,e;for(c=0,d=a.length;c<d;c++)e=a[c],R[e]||(R[e]=[]),R[e].push(b)},d.serialize=function(a){var b=$.extend({},S);return a&&(b.atoms=c.serialize()),e&&(b.elements=e),b.width=N,b.height=O,b},d}}(),function(){function a(){var a=/ (Chrome)\/(.*?) /,c=/ (Firefox)\/([0123456789ab.]+)/,d=/ Version\/([0123456789.]+) (Safari)\/([0123456789.]+)/,e=/ (MSIE) ([0123456789.]+);/,f=/^(Opera)\/.+? Version\/([0123456789.]+)$/,g=/.+?\((iPhone); CPU.+?OS .+?Version\/([0123456789._]+)/,h=/.+?\((iPad); CPU.+?OS .+?Version\/([0123456789._]+)/,i=/.+?\((iPod); CPU (iPhone.+?) like.+?Version\/([0123456789ab._]+)/,j=/.+?(Android) ([0123456789.]+).+?; (.+?)\).+? CrMo\/([0123456789.]+)/,k=/.+?(Android) ([0123456789ab.]+).+?; (.+?)\)/,l;l=navigator.userAgent.match(a);if(l&&l[1])return{browser:l[1],version:l[2],oscpu:b()};l=navigator.userAgent.match(c);if(l&&l[1])return{browser:l[1],version:l[2],oscpu:b()};l=navigator.userAgent.match(j);if(l&&l[1])return{browser:"Chrome",version:l[4],oscpu:l[1]+"/"+l[2]+"/"+l[3]};l=navigator.userAgent.match(k);if(l&&l[1])return{browser:"Android",version:l[2],oscpu:l[1]+"/"+l[2]+"/"+l[3]};l=navigator.userAgent.match(d);if(l&&l[2])return{browser:l[2],version:l[1],oscpu:b()};l=navigator.userAgent.match(e);if(l&&l[1]){var m=navigator.userAgent.match(/\(.*?(Windows.+?); (.+?)[;)].*/);return{browser:l[1],version:l[2],oscpu:windows_platform_token[m[1]]+"/"+navigator.cpuClass+"/"+navigator.platform}}return l=navigator.userAgent.match(f),l&&l[1]?{browser:l[1],version:l[2],oscpu:b()}:(l=navigator.userAgent.match(g),l&&l[1]?{browser:"Mobile Safari",version:l[2],oscpu:l[1]+"/"+"iOS"+"/"+l[2]}:(l=navigator.userAgent.match(h),l&&l[1]?{browser:"Mobile Safari",version:l[2],oscpu:l[1]+"/"+"iOS"+"/"+l[2]}:(l=navigator.userAgent.match(i),l&&l[1]?{browser:"Mobile Safari",version:l[3],oscpu:l[1]+"/"+"iOS"+"/"+l[2]}:{browser:"",version:navigator.appVersion,oscpu:""})))}function b(){var a=navigator.userAgent.match(/\((.+?)[;)] (.+?)[;)].*/);if(!a)return"na";if(a[1]==="Macintosh")return a[2];if(a[1].match(/^Windows/)){var b=windows_feature_token[a[2]]||"32",c=navigator.userAgent.match(/\(.*?(Windows NT.+?)[;)]/);return windows_platform_token[c[1]]+"/"+b}}function c(b,c){function i(){return b.appendChild(document.createElement("tr"))}function l(a,b,c){c=c||"td",a.appendChild(document.createElement(c)).textContent=b}function m(a,b){h&&l(j,a,"th"),l(k,b)}var d=0,e,f,g=[];b.style.display="";var h=b.getElementsByTagName("tr").length===0,j=i(),k=i();f=a(),m("browser",f.browser),m("version",f.version),m("cpu/os",f.oscpu);var n=d3.time.format("%Y-%m-%d %H:%M");m("date",n(new Date));for(d=0;d<c.length;d++)e=c[d],m(e.name,e.run())}typeof console=="undefined"&&(window.console={},console.log=console.info=console.warn=console.error=function(){}),benchmark={},benchmark={version:"0.0.1"},benchmark.what_browser=function(){return a()},benchmark.run=function(a,b){c(a,b)},windows_platform_token={"Windows NT 6.1":"Windows 7","Windows NT 6.0":"Windows Vista","Windows NT 5.2":"Windows Server 2003; Windows XP x64 Edition","Windows NT 5.1":"Windows XP","Windows NT 5.01":"Windows 2000, Service Pack 1 (SP1)","Windows NT 5.0":"Windows 2000","Windows NT 4.0":"Microsoft Windows NT 4.0"},windows_feature_token={WOW64:"64/32","Win64; IA64":"64","Win64; x64":"64"}}(),function(){typeof console=="undefined"&&(window.console={},console.log=console.info=console.warn=console.error=function(){}),function(){arrays={},arrays={version:"0.0.1"},arrays.webgl=!!window.WebGLRenderingContext,arrays.typed=!1;try{var a=new Float64Array(0);arrays.typed=!0}catch(b){}arrays.create=function(a,b,c){c||(arrays.webgl||arrays.typed?c="Float32Array":c="regular"),b=b||0;var d,e;if(c==="regular")d=new Array(a);else switch(c){case"Float64Array":d=new Float64Array(a);break;case"Float32Array":d=new Float32Array(a);break;case"Int32Array":d=new Int32Array(a);break;case"Int16Array":d=new Int16Array(a);break;case"Int8Array":d=new Int8Array(a);break;case"Uint32Array":d=new Uint32Array(a);break;case"Uint16Array":d=new Uint16Array(a);break;case"Uint8Array":d=new Uint8Array(a);break;default:d=new Array(a)}e=-1;while(++e<a)d[e]=b;return d},arrays.constructor_function=function(a){if(a.buffer&&a.buffer.__proto__.constructor)return a.__proto__.constructor;if(a.constructor===Array)return a.constructor;throw new Error("arrays.constructor_function: must be an Array or Typed Array:   source: "+a+", source.constructor: "+a.constructor+", source.buffer: "+a.buffer+", source.buffer.slice: "+(a.buffer?a.buffer.slice:"")+", source.buffer.__proto__: "+(a.buffer?a.buffer.__proto__:"")+", source.buffer.__proto__.constructor: "+(a.buffer?a.buffer.__proto__.constructor:""))},arrays.copy=function(a,b){var c=a.length;i=-1;while(++i<c)b[i]=a[i];return b.length=c,b},arrays.clone=function(a){var b,c=a.length,d,e;e=arrays.constructor_function(a);if(e==Array){d=new e(c);for(b=0;b<c;b++)d[b]=a[b];return d}if(a.buffer.slice)return d=new e(a.buffer.slice(0)),d;d=new e(c);for(b=0;b<c;b++)d[b]=a[b];return d},arrays.between=function(a,b,c){return c<Math.max(a,b)&&c>Math.min(a,b)},arrays.max=function(a){return Math.max.apply(Math,a)},arrays.min=function(a){return Math.min.apply(Math,a)},arrays.maxTypedArray=function(a){var b,c,d=Number.MIN_VALUE,e=a.length;for(c=0;c<e;c++)b=a[c],d=b>d?b:d;return d},arrays.minTypedArray=function(a){var b,c,d=Number.MAX_VALUE,e=a.length;for(c=0;c<e;c++)b=a[c],d=b<d?b:d;return d},arrays.maxAnyArray=function(a){try{return Math.max.apply(Math,a)}catch(b){if(b instanceof TypeError){var c,d,e=Number.MIN_VALUE,f=a.length;for(d=0;d<f;d++)c=a[d],e=c>e?c:e;return e}}},arrays.minAnyArray=function(a){try{return Math.min.apply(Math,a)}catch(b){if(b instanceof TypeError){var c,d,e=Number.MAX_VALUE,f=a.length;for(d=0;d<f;d++)c=a[d],e=c<e?c:e;return e}}},arrays.average=function(a){var b,c=0,d=a.length;for(b=0;b<d;b++)c+=a[b];return c/d}}()}(),function(){function i(){var a=+g.value;g.type==="range"&&(h.innerText=d3.format("4.1f")(a)+" K"),model.set({temperature:a})}function j(){layout.lennard_jones_forces_checkbox.checked?model.set_lennard_jones_forces(!0):model.set_lennard_jones_forces(!1)}function k(){layout.coulomb_forces_checkbox.checked?model.set({coulomb_forces:!0}):model.set({coulomb_forces:!1})}typeof console=="undefined"&&(window.console={},console.log=console.info=console.warn=console.error=function(){}),layout={version:"0.0.1"},layout.selection="",layout.display={},layout.canonical={width:1280,height:800},layout.regular_display=!1,layout.not_rendered=!0,layout.fontsize=!1,layout.cancelFullScreen=!1,layout.screen_factor=1,layout.checkbox_factor=1.1,layout.checkbox_scale=1.1,layout.fullScreenRender=!1,layout.canonical.width=1280,layout.canonical.height=800,layout.getDisplayProperties=function(a){if(!arguments.length)var a={};return a.screen={width:screen.width,height:screen.height},a.client={width:document.body.clientWidth,height:document.body.clientHeight},a.window={width:document.width,height:document.height},a.page={width:layout.getPageWidth(),height:layout.getPageHeight()},a},layout.screenEqualsPage=function(){return layout.display.screen.width===layout.display.page.width||layout.display.screen.height===layout.display.page.height},layout.checkForResize=function(){(layout.display.screen.width!=screen.width||layout.display.screen.height!=screen.height||layout.display.window.width!=document.width||layout.display.window.height!=document.height)&&layout.setupScreen()},layout.setupScreen=function(a){function e(){var b,c,d,e,f,g,h,i,j,k=layout.display.page.width,l=layout.display.page.height;e=a.moleculeContainers[0].scale(),j=e[0]/e[1],i=e[0]/k,c=k*.46,d=c*1/j,d>l*.7&&(d=l*.7,c*d*j),b=-1;while(++b<a.moleculeContainers.length)a.moleculeContainers[b].resize(c,d);h=(k-c)*.415,f=d*.42,b=-1;while(++b<a.potentialCharts.length)a.potentialCharts[b].resize(h,f);b=-1;while(++b<a.speedDistributionCharts.length)a.speedDistributionCharts[b].resize(h,f);g=(k-c)*.86,f=d*.57,b=-1;while(++b<a.energyCharts.length)a.energyCharts[b].resize(g,f)}function f(){var b,c,d,e,f,g=layout.display.page.width,h=layout.display.page.height;e=a.moleculeContainers[0].scale(),f=e[0]/e[1],c=g*.44,d=c*1/f,b=-1;while(++b<a.moleculeContainers.length)a.moleculeContainers[b].resize(c,d);b=-1;while(++b<a.appletContainers.length)a.appletContainers[b].resize(c,d)}function g(){var b,c,d,e,f,g,h,i,j,k=layout.display.page.width,l=layout.display.page.height;e=a.moleculeContainers[0].scale(),j=e[0]/e[1],i=e[0]/k,c=k*.46,d=c*1/j,d>l*.7&&(d=l*.7,c*d*j),b=-1;while(++b<a.moleculeContainers.length)a.moleculeContainers[b].resize(c,d);h=(k-c)*.41,f=d*.42,b=-1;while(++b<a.potentialCharts.length)a.potentialCharts[b].resize(h,f);b=-1;while(++b<a.speedDistributionCharts.length)a.speedDistributionCharts[b].resize(h,f);g=(k-c)*.86,f=d*.57,b=-1;while(++b<a.energyCharts.length)a.energyCharts[b].resize(g,f)}function h(){var b,c,d,e,f;d=Math.min(layout.display.page.height*.5,layout.display.page.width*.53),a.moleculeContainers[0].resize(d,d),e=a.moleculeContainers[0].scale(),f=e[0]/layout.display.page.width,f>.53&&(d*=.53/f,a.moleculeContainers[0].resize(d,d)),a.thermometers[0].resize()}function i(){var b,c,d,e,f,g=document.getElementById("description-right");d=Math.min(layout.display.page.height*.7,layout.display.page.width*.53),a.moleculeContainers[0].resize(d,d),e=a.moleculeContainers[0].scale(),f=e[0]/layout.display.page.width,f>.53&&(d*=.53/f,a.moleculeContainers[0].resize(d,d)),a.thermometers[0].resize()}function j(){var b,c,d,e,f,g,h,i,j,k=layout.display.page.width,l=layout.display.page.height;e=a.moleculeContainers[0].scale(),j=e[0]/e[1],i=e[0]/k,c=k*.8,d=c*1/j,d>l*.8&&(d=l*.8,c*d*j),a.moleculeContainers[0].resize(c,d),e=a.moleculeContainers[0].scale(),a.thermometers[0].resize()}function k(){var b=layout.display.page.height*.7;a.moleculeContainers[0].resize(b,b)}function l(){var a=document.getElementById("description-right");a===null}var b=document.fullScreen||document.webkitIsFullScreen||document.mozFullScreen;layout.display=layout.getDisplayProperties(),layout.regular_display||(layout.regular_display=layout.getDisplayProperties());if(b||layout.fullScreenRender||layout.screenEqualsPage()){layout.fullScreenRender=!0,layout.screen_factor_width=layout.display.page.width/layout.canonical.width,layout.screen_factor_height=layout.display.page.height/layout.canonical.height,layout.screen_factor=layout.screen_factor_height,layout.checkbox_factor=Math.max(.8,layout.checkbox_scale*layout.screen_factor),layout.bodycss.style.fontSize=layout.screen_factor+"em",layout.not_rendered=!0;switch(layout.selection){case"simple-screen":layout.not_rendered&&k();break;case"simple-static-screen":layout.not_rendered&&k();break;case"simple-iframe":k(),l();break;case"compare-screen":var d=Math.min(layout.screen_factor_width*1.1,layout.screen_factor_height);layout.bodycss.style.fontSize=d+"em",f(),layout.not_rendered=!1;break;default:layout.not_rendered&&g()}}else{layout.cancelFullScreen||layout.fullScreenRender?(layout.cancelFullScreen=!1,layout.fullScreenRender=!1,layout.not_rendered=!0,layout.regular_display=layout.previous_display):layout.regular_display=layout.getDisplayProperties(),layout.screen_factor_width=layout.display.page.width/layout.canonical.width,layout.screen_factor_height=layout.display.page.height/layout.canonical.height,layout.screen_factor=layout.screen_factor_height,layout.checkbox_factor=Math.max(.8,layout.checkbox_scale*layout.screen_factor);switch(layout.selection){case"simple-screen":var d=Math.min(layout.screen_factor_width*1.1,layout.screen_factor_height);layout.bodycss.style.fontSize=d+"em",h();break;case"simple-static-screen":if(layout.not_rendered){var d=Math.min(layout.screen_factor_width*1.1,layout.screen_factor_height);layout.bodycss.style.fontSize=d+"em",i(),layout.not_rendered=!1}break;case"simple-iframe":var d=Math.min(layout.screen_factor_width*1.5,layout.screen_factor_height);layout.bodycss.style.fontSize=d+"em",j();break;case"full-static-screen":if(layout.not_rendered){var d=Math.min(layout.screen_factor_width*1.5,layout.screen_factor_height);layout.bodycss.style.fontSize=d+"em",e(),layout.not_rendered=!1}break;case"compare-screen":var d=Math.min(layout.screen_factor_width*1.1,layout.screen_factor_height);layout.bodycss.style.fontSize=d+"em",f();break;default:layout.bodycss.style.fontSize=layout.screen_factor+"em",setupRegularScreen()}layout.regular_display=layout.getDisplayProperties()}layout.transform&&$("input[type=checkbox]").css(layout.transform,"scale("+layout.checkbox_factor+","+layout.checkbox_factor+")"),layout.setupTemperature(model),layout.temperature_control_checkbox&&(model.addPropertiesListener(["temperature_control"],layout.temperatureControlUpdate),layout.temperatureControlUpdate()),c&&(c.style.display="none")},layout.getStyleForSelector=function(a){var b,c=document.styleSheets;for(var d=0;d<c.length;d++)if(c[d])try{b=c[d].rules||c[d].cssRules;if(b)for(var e=0;e<b.length;e++)if(b[e].selectorText==a)return b[e]}catch(f){}return!1},layout.getPageHeight=function(){var a;return self.innerHeight?a=self.innerHeight:document.documentElement&&document.documentElement.clientHeight?a=document.documentElement.clientHeight:document.body&&(a=layout.display.window.height),a},layout.getPageWidth=function(){var a;return self.innerWidth?a=self.innerWidth:document.documentElement&&document.documentElement.clientWidth?a=document.documentElement.clientWidth:document.body&&(a=window.width),a},layout.getTransformProperty=function(a){var b=["transform","WebkitTransform","msTransform","MozTransform","OTransform"],c;while(c=b.shift())if(typeof a.style[c]!="undefined")return c;return!1};var a=document.getElementById("description-right");a!==null&&(layout.fontsize=parseInt(layout.getStyleForSelector("#description-right").style.fontSize)),layout.bodycss=layout.getStyleForSelector("body"),layout.transform=layout.getTransformProperty(document.body),layout.appletContainer=function(a,b){function x(a,b){return arguments.length?(f=b,e=a):(f=c.property("clientHeight"),e=c.property("clientWidth")),g&&(i=+g.runMwScript("mw2d:1:get %width"),j=+g.runMwScript("mw2d:1:get %height"),k=i/j,f=e*1/k*1.25),d.style.width=e+"px",d.style.height=f+"px",n=layout.screen_factor,layout.screen_factor_width&&layout.screen_factor_height&&(n=Math.min(layout.screen_factor_width,layout.screen_factor_height)),n=e/600,o={top:5,right:5,bottom:5,left:5},m=f-o.top-o.bottom,l=e-o.left-o.right,p={width:l,height:m},[e,f]}function y(){function a(){var a,c,d;d=['<applet id="'+b.appletID+'", codebase="'+b.codebase+'", code="'+b.code+'"','     width="'+b.width+'" height="'+b.height+'" MAYSCRIPT="true"','     archive="'+b.archive+'">','     MAYSCRIPT="true">'];for(a=0;a<b.params.length;a++)c=b.params[a],d.push('  <param name="'+c[0]+'" value="'+c[1]+'"/>');return d.push('  <param name="MAYSCRIPT" value="true"/>'),d.push("  Your browser is completely ignoring the applet tag!"),d.push("</applet>"),d.join("\n")}g===undefined?(h=a(),d.innerHTML=h,g=document.getElementById(b.appletID)):(g.style.width=p.width,g.style.height=p.height,g.width=p.width,g.height=p.height),y.node=d,y.scale=x,y.applet=g}var c=d3.select(a),d=c.node(),e=c.property("clientWidth"),f=c.property("clientHeight"),g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v={appletID:"mw-applet",codebase:"/jnlp",code:"org.concord.modeler.MwApplet",width:"100%",height:"100%",archive:"org/concord/modeler/mw.jar",align:"left",hspace:"5",vspace:"5",params:[["script","page:0:import /imports/legacy-mw-content/potential-tests/two-atoms-two-elements/two-atoms-two-elements.cml"]]};if(b)for(var w in v)b[w]===undefined&&(b[w]=v[w]);else b=v;return x(e,f),y.resize=function(a,b){y.scale(a,b)},d&&y(),y},layout.moleculeContainer=function(a,b){function Y(a,j){var k=model.size(),l=k[0]/k[1];arguments.length?(f=j,d.style.height=f+"px",e=f*l):(f=c.property("clientHeight"),e=f*l),d.style.width=e+"px",i=layout.screen_factor,o={top:b.title?40*layout.screen_factor:20,right:25,bottom:10,left:b.ylabel?60*layout.screen_factor:25};if(b.xlabel||b.model_time_label)o.bottom+=35*i;if(b.playback_controller||b.play_only_controller)o.bottom+=40*i;return h=f-o.top-o.bottom,g=e-o.left-o.right,p={width:g,height:h},N=d.offsetLeft+o.left,O=d.offsetTop+o.top,b.playback_controller&&(C=o.left+(p.width-230*i)/2),b.play_only_controller&&(C=o.left+(p.width-140*i)/2),D=f-42*i,q=p.width,r=p.height,v=d3.scale.linear().domain([b.xmin,b.xmax]).range([0,q]),w=v.copy(),x=Math.NaN,y=d3.scale.linear().domain([b.ymax,b.ymin]).nice().range([0,r]).nice(),z=y.copy(),A=Math.NaN,B=null,[e,f]}function Z(){return F+E(model.getTime()/1e3)+G}function $(a){return nodes[model.INDICES.ELEMENT][a]}function _(a){return nodes[model.INDICES.X][a]}function ba(a){return nodes[model.INDICES.Y][a]}function bb(a){return nodes[model.INDICES.RADIUS][a]}function bc(a){return nodes[model.INDICES.SPEED][a]}function bd(a){return nodes[model.INDICES.VX][a]}function be(a){return nodes[model.INDICES.VY][a]}function bf(a){return nodes[model.INDICES.AX][a]}function bg(a){return nodes[model.INDICES.AY][a]}function bh(a){return nodes[model.INDICES.CHARGE][a]}function bi(){function a(){d3.event&&d3.event.transform&&isNaN(x)&&isNaN(A)&&d3.event.transform(v,y);var a=v.tickFormat(10),c=y.tickFormat(10);if(b.xunits){var d=k.selectAll("g.x").data(v.ticks(10),String).attr("transform",s);d.select("text").text(a);var e=d.enter().insert("svg:g","a").attr("class","x").attr("transform",s);b.grid_lines&&e.append("svg:line").attr("stroke",u).attr("y1",0).attr("y2",p.height),e.append("svg:text").attr("y",p.height).attr("dy","1em").attr("text-anchor","middle").text(a),d.exit().remove()}if(b.xunits){var f=k.selectAll("g.y").data(y.ticks(10),String).attr("transform",t);f.select("text").text(c);var g=f.enter().insert("svg:g","a").attr("class","y").attr("transform",t).attr("background-fill","#FFEEB6");b.grid_lines&&g.append("svg:line").attr("stroke",u).attr("x1",0).attr("x2",p.width),g.append("svg:text").attr("x",-3).attr("dy",".35em").attr("text-anchor","end").text(c),b.model_time_label&&n.text(Z()),f.exit().remove()}}function g(){H=k.append("svg").attr("class","container").attr("top",0).attr("left",0).attr("width",p.width).attr("height",p.height).attr("viewBox","0 0 "+p.width+" "+p.height),h("neg-grad","#ffefff","#fdadad","#e95e5e",H),h("pos-grad","#dfffff","#9abeff","#767fbf",H),h("green-grad","#dfffef","#75a643","#2a7216",H),h("purple-grad","#EED3F0","#D941E0","#84198A",H),h("aqua-grad","#DCF5F4","#41E0D8","#12827C",H),h("orange-grad","#F0E6D1","#E0A21B","#AD7F1C",H),L=["green-grad","purple-grad","aqua-grad","orange-grad"]}function h(a,b,c,d,e){gradient=e.append("defs").append("radialGradient").attr("id",a).attr("cx","50%").attr("cy","47%").attr("r","53%").attr("fx","35%").attr("fy","30%"),gradient.append("stop").attr("stop-color",b).attr("offset","0%"),gradient.append("stop").attr("stop-color",c).attr("offset","40%"),gradient.append("stop").attr("stop-color",d).attr("offset","80%"),gradient.append("stop").attr("stop-color",c).attr("offset","100%")}function q(){k.selectAll("circle").data(atoms).attr("r",function(a,b){return v(bb(b))})}function r(){if(typeof atoms=="undefined"||!atoms)return;var a=model.getLJCalculator().coefficients();H.selectAll("circle").remove(),H.selectAll("g").remove(),P=H.selectAll("circle").data(atoms),P.enter().append("circle").attr("r",function(a,b){return v(bb(b))}).attr("cx",function(a,b){return v(_(b))}).attr("cy",function(a,b){return y(ba(b))}).style("cursor","crosshair").style("fill",function(a,b){return model.get("coulomb_forces")?v(bh(b))>0?"url('#pos-grad')":"url('#neg-grad')":(element=$(b)%4,grad=L[element],"url('#"+grad+"')")}).on("mousedown",z).on("mouseout",F);var c=v(a.rmin[0][0]*.5*1.5);model.get("mol_number")>100&&(c*=.9),Q=H.selectAll("g.label").data(atoms),R=Q.enter().append("g").attr("class","label").attr("transform",function(a,b){return"translate("+v(_(b))+","+y(ba(b))+")"}),b.atom_mubers?R.append("text").attr("class","index").attr("font-size",c).attr("style","font-weight: bold; opacity: .7").attr("x",0).attr("y","0.31em").text(function(a){return a.index}):R.append("text").attr("class","index").attr("font-size",c).attr("style","font-weight: bold; opacity: .7").attr("x","-0.31em").attr("y","0.31em").text(function(a,b){if(model.get("coulomb_forces"))return v(bh(b))>0?"+":"";return})}function w(a){}function z(a,b){M?(U.style("opacity",1e-6),U.style("display","none"),M=!1):(d3.event.shiftKey?M=b:M=!1,B(b))}function B(a){U.style("opacity",1).style("display","inline").style("background","rgba(100%, 100%, 100%, 0.5)").style("left",v(nodes[model.INDICES.X][a])+N+16+"px").style("top",y(nodes[model.INDICES.Y][a])+O-30+"px").transition().duration(250),V.text(Z()+"\n"+"speed: "+d3.format("+6.3e")(bc(a))+"\n"+"vx:    "+d3.format("+6.3e")(bd(a))+"\n"+"vy:    "+d3.format("+6.3e")(be(a))+"\n"+"ax:    "+d3.format("+6.3e")(bf(a))+"\n"+"ay:    "+d3.format("+6.3e")(bg(a))+"\n")}function E(a){}function F(){typeof M!="number"&&U.style("opacity",1e-6)}function G(){b.model_time_label&&n.text(Z()),Q=c.selectAll("g.label").data(atoms),Q.attr("transform",function(a,b){return"translate("+v(_(b))+","+y(ba(b))+")"}),P=c.selectAll("circle").data(atoms),P.attr("cx",function(a,b){return v(nodes[model.INDICES.X][b])}).attr("cy",function(a,b){return y(nodes[model.INDICES.Y][b])}).attr("r",function(a,b){return v(nodes[model.INDICES.RADIUS][b])}),typeof M=="number"&&B(M)}Y(),k===undefined?(j=d3.select(d).append("svg").attr("width",e).attr("height",f),k=j.append("g").attr("transform","translate("+o.left+","+o.top+")"),l=k.append("rect").attr("class","plot").attr("width",p.width).attr("height",p.height).style("fill","#EEEEEE"),b.title&&k.append("text").attr("class","title").text(b.title).attr("x",p.width/2).attr("dy","-1em").style("text-anchor","middle"),b.xlabel&&
k.append("text").attr("class","xlabel").text(b.xlabel).attr("x",p.width/2).attr("y",p.height).attr("dy","2.4em").style("text-anchor","middle"),b.ylabel&&k.append("g").append("text").attr("class","ylabel").text(b.ylabel).style("text-anchor","middle").attr("transform","translate(-40 "+p.height/2+") rotate(-90)"),b.model_time_label&&(n=k.append("text").attr("class","model_time_label").text(Z()).attr("x",p.width-100).attr("y",p.height).attr("dy","2.4em").style("text-anchor","start")),b.playback_controller&&(m=new PlaybackComponentSVG(j,model_player,C,D,i)),b.play_only_controller&&(m=new PlayOnlyComponentSVG(j,model_player,C,D,i)),U=d3.select("#viz").append("div").attr("class","tooltip").style("opacity",1e-6),V=U.append("pre"),a(),g()):(d3.select(d).select("svg").attr("width",e).attr("height",f),k.select("svg").attr("width",e).attr("height",f),k.select("rect.plot").attr("width",p.width).attr("height",p.height).style("fill","#EEEEEE"),k.select("svg.container").attr("top",0).attr("left",0).attr("width",p.width).attr("height",p.height).attr("viewBox","0 0 "+p.width+" "+p.height),b.title&&k.select("text.title").attr("x",p.width/2).attr("dy","-1em"),b.xlabel&&k.select("text.xlabel").attr("x",p.width/2).attr("y",p.height),b.ylabel&&k.select("text.ylabel").attr("transform","translate(-40 "+p.height/2+") rotate(-90)"),b.model_time_label&&n.text(Z()).attr("x",p.width-100).attr("y",p.height),k.selectAll("g.x").remove(),k.selectAll("g.y").remove(),P&&(q(),P.attr("cx",function(a,b){return v(_(b))}).attr("cy",function(a,b){return y(ba(b))}).attr("r",function(a,b){return v(bb(b))}),Q.attr("transform",function(a,b){return"translate("+v(_(b))+","+y(ba(b))+")"})),(b.playback_controller||b.play_only_controller)&&m.position(C,D,i),a()),bi.node=d,bi.updateMoleculeRadius=q,bi.setup_particles=r,bi.update_molecule_positions=G,bi.scale=Y,bi.playback_component=m}var c=d3.select(a),d=c.node(),e=c.property("clientWidth"),f=c.property("clientHeight"),g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=d3.format("5.2f"),F="time: ",G=" (ps)",H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W={title:!1,xlabel:!1,ylabel:!1,playback_controller:!1,play_only_controller:!0,model_time_label:!1,grid_lines:!1,xunits:!1,yunits:!1,atom_mubers:!1,xmin:0,xmax:10,ymin:0,ymax:10};if(b)for(var X in W)b[X]===undefined&&(b[X]=W[X]);else b=W;return Y(e,f),s=function(a,b){return"translate("+v(a)+",0)"},t=function(a,b){return"translate(0,"+y(a)+")"},u=function(a,b){return a?"#ccc":"#666"},bi.resize=function(a,b){bi.scale(a,b),bi(),bi.setup_particles()},d&&bi(),bi},layout.potentialChart=function(a,b,c){function D(){var a,c,d,e,f,g;w=b.getLJCalculator(),z.coefficients=w.coefficients(),a=z.coefficients.sigma[0][0],c=z.coefficients.epsilon[0][0],d=z.coefficients.rmin[0][0],z.xmax=a*3,z.xmin=Math.floor(a/2),z.ymax=.4,z.ymin=Math.ceil(c*1)-1,z.variables[0].x=d,z.variables[0].y=c,z.variables[1].x=a,z.variables[1].y=0,A.length=0;for(f=a*.5;f<z.xmax*3;f+=.001)e=-w.potential(f,0,0),Math.abs(e)<100&&A.push([f,e])}function E(a,b){f=a,g=b,e.style.width=f+"px",e.style.height=g+"px",h={top:c.title?40:20,right:35,bottom:c.xlabel?56:30,left:c.ylabel?60:25},width=f-h.left-h.right,height=g-h.top-h.bottom,i={width:width,height:height},j=i.width,k=i.height,o.domain([z.xmin,z.xmax]).range([0,j]),q.domain([z.ymax,z.ymin]).range([0,k]),p=Math.NaN,r=Math.NaN,s=null}function F(){function a(){d3.event&&d3.event.transform&&isNaN(p)&&isNaN(r)&&d3.event.transform(x,y);var b=o.tickFormat(5),c=q.tickFormat(10),d=u.selectAll("g.x").data(o.ticks(5),String).attr("transform",l);d.select("text").text(b);var e=d.enter().insert("g","a").attr("class","x").attr("transform",l);e.append("line").attr("stroke",n).attr("y1",0).attr("y2",i.height),e.append("text").attr("y",i.height).attr("dy","1em").attr("text-anchor","middle").style("cursor","ew-resize").text(b).on("mouseover",function(a){d3.select(this).style("font-weight","bold")}).on("mouseout",function(a){d3.select(this).style("font-weight","normal")}).on("mousedown",function(a){var b=d3.svg.mouse(u[0][0]);p=o.invert(b[0])}),d.exit().remove();var f=u.selectAll("g.y").data(q.ticks(10),String).attr("transform",m);f.select("text").text(c);var g=f.enter().insert("g","a").attr("class","y").attr("transform",m).attr("background-fill","#FFEEB6");g.append("line").attr("stroke",n).attr("x1",0).attr("x2",i.width),g.append("text").attr("x",-3).attr("dy",".35em").attr("text-anchor","end").style("cursor","ns-resize").text(c).on("mouseover",function(a){d3.select(this).style("font-weight","bold")}).on("mouseout",function(a){d3.select(this).style("font-weight","normal")}).on("mousedown",function(a){var b=d3.svg.mouse(u[0][0]);r=q.invert(b[1])}),f.exit().remove(),v.call(d3.behavior.zoom().x(o).y(q).scaleExtent([1,8]).on("zoom",a)),j()}function j(){var a=u.selectAll("circle").data(z.variables,function(a){return a}),b=u.select("path").attr("d",line(A)),c=o.domain()[1]-o.domain()[0];a.enter().append("circle").attr("class",function(a){return a===t?"selected":null}).attr("cx",function(a){return o(a.x)}).attr("cy",function(a){return q(a.y)}).style("cursor",function(a){return a.cursorStyle}).attr("r",8).on("mousedown",function(a){a.coefficient=="epsilon"?a.x=z.coefficients.rmin:a.y=0,coefficient_selected=t=a,j()}),a.attr("class",function(a){return a===coefficient_selected?"selected":null}).attr("cx",function(a){return o(a.x)}).attr("cy",function(a){return q(a.y)}),a.exit().remove(),d3.event&&d3.event.keyCode&&(d3.event.preventDefault(),d3.event.stopPropagation())}function k(){d.style("cursor","move")}function s(){if(!t)return;e.onselectstart=function(){return!1};var a=d3.svg.mouse(u.node()),d,f;t.coefficient=="epsilon"?(d=z.coefficients.rmin,f=q.invert(Math.max(0,Math.min(i.height,a[1]))),f>c.epsilon_max&&(f=c.epsilon_max),f<c.epsilon_min&&(f=c.epsilon_min),b.set({epsilon:f})):(f=0,d=o.invert(Math.max(0,Math.min(i.width,a[0]))),d<c.sigma_min&&(d=c.sigma_min),d>c.sigma_max&&(d=c.sigma_max),b.set({sigma:d})),t.x=d,t.y=f,j()}function w(){isNaN(p)||(e.onselectstart=function(){return!0},a(),p=Math.NaN,d3.event.preventDefault(),d3.event.stopPropagation()),isNaN(r)||(a(),r=Math.NaN,d3.event.preventDefault(),d3.event.stopPropagation()),t=null}E(f,g),u===undefined?(u=d3.select(e).append("svg").attr("width",f).attr("height",g).append("svg:g").attr("transform","translate("+h.left+","+h.top+")"),v=u.append("rect").attr("class","plot").attr("width",i.width).attr("height",i.height).style("fill","#EEEEEE").attr("pointer-events","all"),v.call(d3.behavior.zoom().x(o).y(q).scaleExtent([1,8]).on("zoom",a)),u.append("svg").attr("class","linebox").attr("top",0).attr("left",0).attr("width",i.width).attr("height",i.height).attr("viewBox","0 0 "+i.width+" "+i.height).append("path").attr("class","line").attr("d",line(A)),c.title&&u.append("text").attr("class","title").text(c.title).attr("x",i.width/2).attr("dy","-1em").style("text-anchor","middle"),c.xlabel&&u.append("text").attr("class","xlabel").text(c.xlabel).attr("x",i.width/2).attr("y",i.height).attr("dy","2.4em").style("text-anchor","middle"),c.ylabel&&u.append("g").append("text").attr("class","ylabel").text(c.ylabel).style("text-anchor","middle").attr("transform","translate(-40 "+i.height/2+") rotate(-90)"),u.on("mousemove",s).on("mouseup",w),a()):(d3.select(e).select("svg").attr("width",f).attr("height",g),u.select("svg").attr("width",f).attr("height",g),u.select("rect.plot").attr("width",i.width).attr("height",i.height).style("fill","#EEEEEE"),u.select("svg.container").attr("top",0).attr("left",0).attr("width",i.width).attr("height",i.height).attr("viewBox","0 0 "+i.width+" "+i.height),u.select("svg.linebox").attr("top",0).attr("left",0).attr("width",i.width).attr("height",i.height).attr("viewBox","0 0 "+i.width+" "+i.height),c.title&&u.select("text.title").attr("x",i.width/2).attr("dy","-1em"),c.xlabel&&u.select("text.xlabel").attr("x",i.width/2).attr("y",i.height),c.ylabel&&u.select("text.ylabel").attr("transform","translate(-40 "+i.height/2+") rotate(-90)"),u.selectAll("g.x").remove(),u.selectAll("g.y").remove(),a()),d.on("mousemove",function(b){document.onselectstart=function(){return!0};var c=d3.svg.mouse(u[0][0]);if(!isNaN(p)){var d=o.invert(c[0]),e=o.domain()[0],f=o.domain()[1],g=f-e;if(d!==0){var h,i,j;i=g/p,h=1+(p/d-1)*(g/(p-e))/i,j=[e,e+g*h],o.domain(j),a()}d3.event.preventDefault(),d3.event.stopPropagation()}if(!isNaN(r)){var k=q.invert(c[1]),l=q.domain()[1],m=q.domain()[0],n=m-l;if(k!==0){var s,t,v;t=n/r,s=1-(k/r-1)*(n/(r-l))/t,v=[l+n*s,l],q.domain(v),a()}d3.event.preventDefault(),d3.event.stopPropagation()}}).on("mouseup",function(b){document.onselectstart=function(){return!0},isNaN(p)||(a(),p=Math.NaN,d3.event.preventDefault(),d3.event.stopPropagation()),isNaN(r)||(a(),r=Math.NaN,d3.event.preventDefault(),d3.event.stopPropagation())}),F.node=e,F.scale=E,F.updateLJData=D,F.update=j,F.redraw=a}var d=d3.select(a),e=d.node(),f=d.property("clientWidth"),g=d.property("clientHeight"),h,i,j,k,l,m,n,o=d3.scale.linear(),p,q=d3.scale.linear(),r,s,t,u,v,w,z={},A=[],B={title:"Lennard-Jones potential",xlabel:"Radius",ylabel:"Potential Energy"};if(c)for(var C in B)c[C]===undefined&&(c[C]=B[C]);else c=B;return z.variables=[],z.variables[0]={coefficient:"epsilon",cursorStyle:"ns-resize"},z.variables[1]={coefficient:"sigma",cursorStyle:"ew-resize"},D(),t=!1,coefficient_selected=z.variables[0],E(f,g),l=function(a,b){return"translate("+o(a)+",0)"},m=function(a,b){return"translate(0,"+q(a)+")"},n=function(a,b){return Math.abs(a)>1e-4?"#ccc":"#666"},line=d3.svg.line().x(function(a,b){return o(A[b][0])}).y(function(a,b){return q(A[b][1])}),F.resize=function(a,b){F.scale(a,b),F()},F.ljUpdate=function(){F.updateLJData(),F.redraw()},e&&F(),F},layout.speedDistributionChart=function(a,b){function J(){E=model.get_speed(),b.xmax=d3.max(E),b.xmin=d3.min(E),b.quantile=d3.quantile(E,.1),w=b.ymax,n=d3.scale.linear().domain([b.xmin,b.xmax]).range([0,i]),q=d3.scale.linear().domain([b.ymax,b.ymin]).nice().range([0,j])}function K(){if(E.length>2){try{G=d3.layout.histogram().frequency(!1).bins(n.ticks(60))(E)}catch(a){return}t=(h.width-G.length)/G.length,v=(b.xmax-b.xmin)/G.length,z=d3.max(G,function(a){return a.y})}}function L(a,c){e=a,f=c,d.style.width=e+"px",d.style.height=f+"px",g={top:b.title?40:20,right:35,bottom:b.xlabel?56:30,left:b.ylabel?60:25},width=e-g.left-g.right,height=f-g.top-g.bottom,h={width:width,height:height},i=h.width,j=h.height,n=d3.scale.linear().domain([b.xmin,b.xmax]).range([0,i]),q=d3.scale.linear().domain([b.ymax,b.ymin]).nice().range([0,j]).nice(),J(),K()}function M(){function a(){d3.event&&d3.event.transform&&isNaN(p)&&isNaN(s)&&d3.event.transform(x,y);var a=q.tickFormat(10),b=A.selectAll("g.y").data(q.ticks(5),String).attr("transform",l);b.select("text").text(a);var d=b.enter().insert("g","a").attr("class","y").attr("transform",l).attr("background-fill","#FFEEB6");d.append("line").attr("stroke",m).attr("x1",0).attr("x2",h.width),d.append("text").attr("x",-3).attr("dy",".35em").attr("text-anchor","end").style("cursor","ns-resize").text(a).on("mouseover",function(a){d3.select(this).style("font-weight","bold")}).on("mouseout",function(a){d3.select(this).style("font-weight","normal")}).on("mousedown",function(a){var b=d3.svg.mouse(A[0][0]);s=y.invert(b[1])}),b.exit().remove(),c()}function c(){J();if(E.length>2){kde=science.stats.kde().sample(E),n.domain([b.xmin,b.xmax]);try{G=d3.layout.histogram().frequency(!0).bins(n.ticks(60))(E)}catch(a){return}t=(h.width-G.length)/G.length,v=(b.xmax-b.xmin)/G.length,z=d3.max(G,function(a){return a.y}),A.selectAll("g.bar").remove(),C=A.selectAll("g.bar").data(G),C.enter().append("g").attr("class","bar").attr("transform",function(a,b){return"translate("+n(a.x)+","+(j-q(w-a.y))+")"}).append("rect").attr("class","bar").attr("fill","steelblue").attr("width",t).attr("height",function(a){return q(w-a.y)})}}L(e,f),A===undefined?(A=d3.select(d).append("svg").attr("width",e).attr("height",f).append("g").attr("transform","translate("+g.left+","+g.top+")"),B=A.append("rect").attr("class","plot").attr("width",h.width).attr("height",h.height).style("fill","#EEEEEE"),b.title&&A.append("text").attr("class","title").text(b.title).attr("x",h.width/2).attr("dy","-1em").style("text-anchor","middle"),b.xlabel&&A.append("text").attr("class","xlabel").text(b.xlabel).attr("x",h.width/2).attr("y",h.height).attr("dy","2.4em").style("text-anchor","middle"),b.ylabel&&A.append("g").append("text").attr("class","ylabel").text(b.ylabel).style("text-anchor","middle").attr("transform","translate(-40 "+h.height/2+") rotate(-90)"),a()):(d3.select(d).select("svg").attr("width",e).attr("height",f),A.select("rect.plot").attr("width",h.width).attr("height",h.height).style("fill","#EEEEEE"),b.title&&A.select("text.title").attr("x",h.width/2).attr("dy","-1em"),b.xlabel&&A.select("text.xlabel").attr("x",h.width/2).attr("y",h.height),b.ylabel&&A.select("text.ylabel").attr("transform","translate(-40 "+h.height/2+") rotate(-90)"),A.selectAll("g.x").remove(),A.selectAll("g.y").remove(),a()),M.node=d,M.scale=L,M.update=c,M.redraw=a}var c=d3.select(a),d=c.node(),e=c.property("clientWidth"),f=c.property("clientHeight"),g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,z,A,B,C,D,E,F,G,H={title:"Distribution of Speeds",xlabel:null,ylabel:"Count",xmax:2,xmin:0,ymax:15,ymin:0,quantile:.01};if(b)for(var I in H)b[I]===undefined&&(b[I]=H[I]);else b=H;return L(e,f),k=function(a,b){return"translate("+n(a)+",0)"},l=function(a,b){return"translate(0,"+q(a)+")"},m=function(a,b){return a?"#ccc":"#666"},M.resize=function(a,b){M.scale(a,b),M()},d&&M(),M};var b=document.getElementById("start-benchmarks"),c=document.getElementById("benchmarks-table"),d=[{name:"molecules",run:function(){return model.get_atoms().length}},{name:"temperature",run:function(){return model.get("temperature")}},{name:"100 Steps (steps/s)",run:function(){controller.modelStop();var a=+Date.now(),b=-1;while(b++<100)model.tick();return elapsed=Date.now()-a,d3.format("5.1f")(100/elapsed*1e3)}},{name:"100 Steps w/graphics",run:function(){controller.modelStop();var a=+Date.now(),b=-1;while(b++<100)model.tick(),controller.modelListener();return elapsed=Date.now()-a,d3.format("5.1f")(100/elapsed*1e3)}}];b&&(b.onclick=function(){benchmark.run(c,d)}),layout.datatable_visible=!1;var e=document.getElementById("toggle-datatable"),f=document.getElementById("datatable-table");layout.hide_datatable=function(){f&&(f.style.display="none")},layout.render_datatable=function(a){function k(){return f.getElementsByTagName("tr").length==0}function l(a){a=a||"data";var b=f.appendChild(document.createElement("tr"));return b.className=a,b}function m(a,b,c,d){c=c||"td",d=d||1;var e=a.appendChild(document.createElement(c));e.textContent=b,d>1&&(e.colSpan=d)}function n(a,b,c){c=c||"td";var d;d=-1;while(++d<b.length)m(a,b[d])}function o(a,b,c){c=c||"td";var d=a.getElementsByTagName(c),f=0;if(d.length>0){d[0].textContent=b;while(++f<d.length)d[f].textContent=j[f](nodes[model.INDICES[e[f]]][b])}f--;while(++f<e.length)m(a,j[f](nodes[model.INDICES[e[f]]][b]))}function p(a,b){k()&&m(l("title"),a,"th"),m(results_row,b)}function q(a,b,c){c=c||1;var d;d=-1;while(++d<b.length)m(a,b[d],"th",c)}function r(a){var b=-1,c=d.length;while(++b<a)b>=d.length&&l();while(--c>=b)f.removeChild(d[b]);return f.getElementsByClassName("data")}function s(a,b){var c=-1;while(++c<b.length)m(a,b[c])}function t(a,b,c,d){var e;e=-1;while(++e<d.length)s(b[e],d[e])}f.style.display="";var b,c=f.getElementsByClassName("title"),d=f.getElementsByClassName("data"),e=["PX","PY","X","Y","VX","VY","AX","AY","SPEED","CHARGE","RADIUS","ELEMENT"],g=d3.format(" 2d"),h=d3.format(" 1.1f"),i=d3.format(" 3.4f"),j=[i,i,i,i,i,i,i,i,i,h,i,g];a=a||!1;if(c.length==0){var u=l("title");q(u,e),d=r(atoms.length)}a&&(d=r(atoms.length)),b=-1;while(++b<atoms.length)o(d[b],b)},e&&(e.onclick=function(){layout.datatable_visible?(layout.datatable_visible=!1,e.textContent="Show Data Table",f.style.display="none"):(layout.datatable_visible=!0,e.textContent="Hide Data Table",layout.render_datatable(),f.style.display="")});var g=document.getElementById("select-temperature"),h=document.createElement("span");layout.setupTemperature=function(a){if(g){if(Modernizr.inputtypes.range){var b=document.createElement("input");b.type="range",b.min="0",b.max="1000",b.step="20",b.value=a.get("temperature"),g.parentNode.replaceChild(b,g),b.id="select-temperature",g=b,h.id="select-temperature-display",h.innerText=b.value+" K",g.parentNode.appendChild(h),g=document.getElementById("select-temperature")}g.onchange=i}},layout.temperature_control_checkbox=document.getElementById("temperature-control-checkbox"),layout.temperatureControlHandler=function(){layout.temperature_control_checkbox.checked?model.set({temperature_control:!0}):model.set({temperature_control:!1})},layout.temperatureControlUpdate=function(){var a=model.get("temperature_control");layout.temperature_control_checkbox.checked=a,g.disabled=!a,h.hidden=!a},layout.temperature_control_checkbox&&(layout.temperature_control_checkbox.onchange=layout.temperatureControlHandler),layout.lennard_jones_forces_checkbox=document.getElementById("lennard-jones-forces-checkbox"),layout.lennard_jones_forces_checkbox&&(layout.lennard_jones_forces_checkbox.onchange=j),layout.coulomb_forces_checkbox=document.getElementById("coulomb-forces-checkbox"),layout.coulomb_forces_checkbox&&(layout.coulomb_forces_checkbox.onchange=k);var l=document.getElementById("stats");layout.displayStats=function(){var a=model.ke(),b=model.pe(),c=a+b;l&&(l.textContent="Time: "+d3.format("5.2f")(model.getTime()/1e3)+" (ps), "+"KE: "+d3.format("1.4f")(a)+", "+"PE: "+d3.format("1.4f")(b)+", "+"TE: "+d3.format("1.4f")(c)+", "+"Pressure: "+d3.format("6.3f")(model.pressure())+", "+"Rate: "+d3.format("5.1f")(model.get_rate())+" (steps/s)")};if(document.querySelectorAll){var m=document.querySelector("#fullscreen");m&&(m.style.cursor="pointer",m.addEventListener("click",function(){var a=document.documentElement,b=a.requestFullScreen||a.webkitRequestFullScreen||a.mozRequestFullScreen,c=document.fullScreen||document.webkitIsFullScreen||document.mozFullScreen,d=document.cancelFullScreen||document.webkitCancelFullScreen||document.mozCancelFullScreen;b?c?(layout.cancelFullScreen=!0,d.call(document)):(layout.cancelFullScreen=!1,b.call(a)):alert("You'll need to use a newer browser to use the\nfull-screen API.\n\nChrome v15 (beta)\nhttp://www.google.com/landing/chrome/beta/\n\nChrome v17 Canary:\nhttp://tools.google.com/dlpage/chromesxs\n\nSafari v5.1.1:\n\nFireFox v9 Aurora:\nhttps://www.mozilla.org/en-US/firefox/channel/\n\nFireFox v10 Nightly\nhttp://nightly.mozilla.org/\nOpen 'about:config' and set: full-screen-api-enabled")},!1))}layout.heatCoolButtons=function(a,b,c,d,e,f){var g=new ButtonComponent(a,"circlesmall-plus"),h=new ButtonComponent(b,"circlesmall-minus");g.add_action(function(){var c=e.get("temperature");c<d?($(a).removeClass("inactive"),$(b).removeClass("inactive"),c=Math.floor(c*2)/2+100,e.set({temperature:c}),typeof f=="function"&&f(c)):$(a).addClass("inactive")}),h.add_action(function(){var d=e.get("temperature");d>c?($(a).removeClass("inactive"),$(b).removeClass("inactive"),d=Math.floor(d*2)/2-100,e.set({temperature:d}),typeof f=="function"&&f(d)):$(b).addClass("inactive")})}}(),function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n=Object.prototype.hasOwnProperty,o=function(a,b){function d(){this.constructor=a}for(var c in b)n.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a},p=function(a,b){return function(){return a.apply(b,arguments)}};m=typeof exports!="undefined"&&exports!==null?exports:this,c=function(){function a(a){this.dom_id=a,this.dom_id?this.dom_element=$(this.dom_id):this.dom_element=$("<div>"),this.dom_element.addClass("component")}return a}(),b=function(a){function b(a,c,d){this.dom_id=a,this.name=c!=null?c:"play",this.actions=d!=null?d:[],b.__super__.constructor.call(this,this.dom_id),this.dom_element.addClass("button").addClass(this.name).addClass("up"),this.state="up",this.init_mouse_handlers()}return o(b,a),b.prototype.set_state=function(a){return this.dom_element.removeClass(this.state),this.state=a,this.dom_element.addClass(this.state)},b.prototype.init_mouse_handlers=function(){var a,b=this;return a=this,this.dom_element.mousedown(function(b){return a.set_state("down"),a.start_down_ticker()}),this.dom_element.mouseup(function(){return clearInterval(b.ticker),a.set_state("up"),a.do_action()}),this.dom_element.mouseleave(function(){return clearInterval(b.ticker),a.set_state("up")})},b.prototype.add_action=function(a){return this.actions.push(a)},b.prototype.do_action=function(){var a,b,c,d,e;d=this.actions,e=[];for(b=0,c=d.length;b<c;b++)a=d[b],e.push(a());return e},b.prototype.start_down_ticker=function(){var a;return a=this,this.ticker_count=0,this.ticker=setInterval(function(){a.do_action(),a.ticker_count+=1,a.ticker_count>4&&a.do_action();if(a.ticker_count>8)return a.do_action(),a.do_action()},250)},b}(c),m.ButtonComponent=b,l=function(a){function b(a,c){var d,e,f;this.dom_id=a,c==null&&(c=[]),b.__super__.constructor.call(this,this.dom_id,"toggle"),this.buttons=[];for(e=0,f=c.length;e<f;e++)d=c[e],this.add_button(d);this.button_index=0,this.enable_button(0)}return o(b,a),b.prototype.add_button=function(a){var b,c;a.dom_element.remove(),a.dom_element.css("margin","0px"),this.dom_element.append(a.dom_element),this.buttons.push(a),this.add_width(a.dom_element),this.add_height(a.dom_element),c=this,b=this.buttons.length-1;if(b!==this.button_index)return this.disable_button(b)},b.prototype.add_width=function(a){var b,c;c=this.dom_element.width(),b=a.outerWidth(!0);if(c<b)return this.dom_element.width(""+b+"px")},b.prototype.add_height=function(a){var b,c;c=this.dom_element.height(),b=a.outerHeight(!0);if(c<b)return this.dom_element.height(""+b+"px")},b.prototype.disable_button=function(a){var b;b=this.buttons[a];if(b)return b.dom_element.addClass("hidden")},b.prototype.enable_button=function(a){var b;b=this.buttons[a];if(b)return b.dom_element.removeClass("hidden")},b.prototype.set_active=function(a){return this.disable_button(this.button_index),this.button_index=a,this.button_index=this.button_index%this.buttons.length,this.enable_button(this.button_index)},b.prototype.enable_next_button=function(){return this.set_active(this.button_index+1)},b.prototype.current_button=function(){return this.button_index<this.buttons.length?this.buttons[this.button_index]:null},b.prototype.do_action=function(){if(this.current_button())return this.current_button().do_action(),this.enable_next_button()},b}(b),m.ToggleButtonComponent=l,a=function(a){function b(a,c){var d,e,f;this.dom_id=a,c==null&&(c=[]),b.__super__.constructor.call(this,this.dom_id),this.dom_element.addClass("button_bar"),this.buttons=[],this.dom_element.width("1px"),this.dom_element.height("1px");for(e=0,f=c.length;e<f;e++)d=c[e],this.add_button(d)}return o(b,a),b.prototype.add_button=function(a){var b;return b=a.dom_element,this.dom_element.append(b),this.add_width(b),this.add_height(b),this.buttons.push(a)},b.prototype.add_width=function(a){var b;return b=this.dom_element.width(),b+=a.outerWidth(!0),this.dom_element.width(""+b+"px")},b.prototype.add_height=function(a){var b,c;c=this.dom_element.height(),b=a.outerHeight(!0);if(c<b)return this.dom_element.height(""+b+"px")},b}(c),m.ButtonBarComponent=a,g=function(a){function c(a,d,e){var f,g,h,i,j,k=this;this.dom_id=a,this.playable=d,e==null&&(e=!0),c.__super__.constructor.call(this,this.dom_id),i=new b(null,"play"),i.add_action(function(){return k.playable.play()}),h=new b(null,"pause"),h.add_action(function(){return k.playable.stop()}),this.toggle=new l(null,[i,h]),this.play_index=0,this.stop_index=1,j=new b(null,"reset"),j.add_action(function(){return k.playable.seek(1),k.play()}),this.add_button(j),e||(g=new b(null,"forward"),g.add_action(function(){return k.playable.forward(),k.stop()}),this.add_button(g)),this.add_button(this.toggle),e||(f=new b(null,"back"),f.add_action(function(){return k.playable.back(),k.stop()}),this.add_button(f)),this.play()}return o(c,a),c.prototype.stop=function(){return this.toggle.set_active(this.play_index)},c.prototype.play=function(){return this.toggle.set_active(this.stop_index)},c}(a),m.PlaybackBarComponent=g,d=function(){function a(a,b){var c=this;this.dom_id=a!=null?a:"#slider",this.value_changed_function=b,this.dom_element=$(this.dom_id),this.precision=this.dom_element.attr("data-precision")||3,this.min=this.dom_element.attr("data-min")||0,this.max=this.dom_element.attr("data-max")||1,this.step=this.dom_element.attr("data-stop")||.01,this.value=this.dom_element.attr("data-value")||.5,this.label=this.dom_element.attr("data-label"),this.label_id=this.dom_element.attr("data-label-id"),this.orientation=this.dom_element.attr("data-orientation")||"horizontal",this.dom_element.slider(),this.update_options(),this.dom_element.bind("slide",function(a,b){console.log("slider value: "+b.value),c.update_label(b.value);if(c.value_changed_function)return c.value_changed_function(b.value)}),this.update_label(this.value)}return a.prototype.set_max=function(a){return this.max=a,this.update_options()},a.prototype.set_min=function(a){return this.min=a,this.update_options()},a.prototype.update_options=function(){var a;return a={orientation:this.orientation,min:this.min,max:this.max,value:this.value,step:this.step,range:"min"},this.dom_element.slider("option",a)},a.prototype.update_label=function(a){if(this.label_id)return $(this.label_id).text(""+this.label+" "+a)},a}(),m=typeof exports!="undefined"&&exports!==null?exports:this,m.JSliderComponent=d,f=function(){function a(a,b,c,d,e){this.svg_element=a,this.playable=b!=null?b:null,this.offsets={play:1,stop:1},this.width=200,this.height=34,this.xpos=c,this.ypos=d,this.scale=e||1,this.unit_width=this.width/9,this.vertical_padding=(this.height-this.unit_width)/2,this.stroke_width=this.unit_width/10,this.init_view()}return a.prototype.offset=function(a){return this.offsets[a]*this.unit_width*2+this.unit_width},a.prototype.make_button=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=this;g=this.group.append("svg:g"),l=this.offset(a),g.attr("class","component playbacksvgbutton").attr("x",l).attr("y",this.vertical_padding).attr("width",this.unit_width).attr("height",this.unit_width*2).attr("style","fill: #cccccc"),f=g.append("rect"),f.attr("class","bg").attr("x",this.offset(a)/1.2).attr("y",this.vertical_padding/3).attr("width",this.unit_width*2).attr("height",this.unit_width*1.5).attr("rx","0");for(n=0,p=c.length;n<p;n++){j=c[n],d=g.append(b),d.attr("class",""+a+" button-art"),k="";for(o=0,q=j.length;o<q;o++)i=j[o],l=this.offset(a)+i.x*this.unit_width,m=this.vertical_padding/.75+i.y*this.unit_width,k+=" "+l+","+m,d.attr("points",k);a==="stop"&&(e=g.append("rect"),e.attr("class","pause-center").attr("x",l+this.unit_width/3).attr("y",this.vertical_padding/.75-1).attr("width",this.unit_width/3).attr("height",this.unit_width+2))}return h=g.append("rect"),h.attr("class","highlight").attr("x",this.offset(a)/1.2+1).attr("y",this.vertical_padding/1.85).attr("width",this.unit_width*2-2).attr("height",this.unit_width/1.4).attr("rx","0"),g.on("click",function(){return r.action(a)}),g},a.prototype.action=function(a){console.log("running "+a+" ");if(this.playable)switch(a){case"play":this.playable.play();break;case"stop":this.playable.stop();break;case"forward":this.playable.forward();break;case"back":this.playable.back();break;case"reset":this.playable.seek(1);break;default:console.log("cant find action for "+a)}else console.log("no @playable defined");return this.update_ui()},a.prototype.init_play_button=function(){var a;return a=[[{x:0,y:0},{x:1,y:.5},{x:0,y:1}]],this.play=this.make_button("play","svg:polygon",a)},a.prototype.init_stop_button=function(){var a;return a=[[{x:0,y:0},{x:1,y:0},{x:1,y:1},{x:0,y:1},{x:0,y:0}]],this.stop=this.make_button("stop","svg:polygon",a)},a.prototype.init_pause_button=function(){var a;return a=[[{x:.5,y:.5},{x:.5,y:0},{x:.5,y:1},{x:0,y:1},{x:0,y:0}]],this.pause=this.make_button("pause","svg:polygon",a)},a.prototype.init_view=function(){return this.svg=this.svg_element.append("svg:svg").attr("class","component playbacksvg").attr("x",this.xpos).attr("y",this.ypos),this.group=this.svg.append("g").attr("transform","scale("+this.scale+","+this.scale+")").attr("width",this.width).attr("height",this.height),this.init_play_button(),this.init_stop_button(),this.playable.playing?this.hide(this.play):this.hide(this.stop)},a.prototype.position=function(a,b,c){return this.xpos=a,this.ypos=b,this.scale=c||1,this.svg.attr("x",this.xpos).attr("y",this.ypos),this.group.attr("transform","scale("+this.scale+","+this.scale+")").attr("width",this.width).attr("height",this.height)},a.prototype.update_ui=function(){if(this.playable)return this.playable.playing?(this.hide(this.play),this.show(this.stop)):(this.hide(this.stop),this.show(this.play))},a.prototype.hide=function(a){return a.style("visibility","hidden")},a.prototype.show=function(a){return a.style("visibility","visible")},a}(),m=typeof exports!="undefined"&&exports!==null?exports:this,m.PlayOnlyComponentSVG=f,m.ModelPlayer=e,e=function(){function a(a,b){this.model=a,arguments.length>1?this.playing=b:this.playing=!0}return a.prototype.play=function(){return this.model.resume(),this.playing=!0},a.prototype.stop=function(){return this.model.stop(),this.playing=!1},a.prototype.forward=function(){return this.stop(),this.model.stepForward()},a.prototype.back=function(){return this.stop(),this.model.stepBack()},a.prototype.seek=function(a){return this.stop(),this.model.seek(a)},a}(),h=function(){function a(a,b){this.dom_id=a!=null?a:"#playback",this.playable=b!=null?b:null,this.dom_element=d3.select(this.dom_id).attr("class","component playback"),this.offsets={reset:0,back:1,play:2,stop:2,forward:3},this.width=parseInt(this.dom_element.style("width")),this.height=parseInt(this.dom_element.style("height")),this.unit_width=this.width/9,this.height<this.unit_width&&(this.height=this.unit_width+2,this.dom_element.style("height",this.height+"px")),this.vertical_padding=(this.height-this.unit_width)/2,this.stroke_width=this.unit_width/10,this.init_view()}return a.prototype.offset=function(a){return this.offsets[a]*this.unit_width*2+this.unit_width},a.prototype.make_button=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o=this;e=this.svg.append("svg:g"),i=this.offset(a),e.attr("x",i).attr("y",this.vertical_padding).attr("width",this.unit_width).attr("height",this.unit_width);for(k=0,m=c.length;k<m;k++){g=c[k],d=e.append(b),d.attr("class",""+a+" button-art"),h="";for(l=0,n=g.length;l<n;l++)f=g[l],i=this.offset(a)+f.x*this.unit_width,j=this.vertical_padding+f.y*this.unit_width,h+=" "+i+","+j,d.attr("points",h)}return e.on("click",function(){return o.action(a)}),e},a.prototype.action=function(a){console.log("running "+a+" ");if(this.playable)switch(a){case"play":this.playable.play();break;case"stop":this.playable.stop();break;case"forward":this.playable.forward();break;case"back":this.playable.back();break;case"reset":this.playable.seek(1);break;default:console.log("cant find action for "+a)}else console.log("no @playable defined");return this.update_ui()},a.prototype.init_reset_button=function(){var a;return a=[[{x:0,y:0},{x:0,y:1},{x:1,y:1},{x:1,y:0},{x:.25,y:0},{x:.5,y:.25}]],this.reset=this.make_button("reset","svg:polyline",a)},a.prototype.init_play_button=function(){var a;return a=[[{x:0,y:0},{x:1,y:.5},{x:0,y:1}]],this.play=this.make_button("play","svg:polygon",a)},a.prototype.init_stop_button=function(){var a;return a=[[{x:0,y:0},{x:1,y:0},{x:1,y:1},{x:0,y:1},{x:0,y:0}]],this.stop=this.make_button("stop","svg:polygon",a)},a.prototype.init_back_button=function(){var a;return a=[[{x:.5,y:0},{x:0,y:.5},{x:.5,y:1}],[{x:1,y:0},{x:.5,y:.5},{x:1,y:1}]],this.back=this.make_button("back","svg:polyline",a)},a.prototype.init_forward_button=function(){var a;return a=[[{x:.5,y:0},{x:1,y:.5},{x:.5,y:1}],[{x:0,y:0},{x:.5,y:.5},{x:0,y:1}]],this.forward=this.make_button("forward","svg:polyline",a)},a.prototype.init_view=function(){return this.svg=this.dom_element.append("svg:svg").attr("width",this.width).attr("height",this.height),this.init_reset_button(),this.init_play_button(),this.init_stop_button(),this.init_forward_button(),this.init_back_button(),this.hide(this.play)},a.prototype.update_ui=function(){if(this.playable)return this.playable.playing?(this.hide(this.play),this.show(this.stop)):(this.hide(this.stop),this.show(this.play))},a.prototype.hide=function(a){return a.style("visibility","hidden")},a.prototype.show=function(a){return a.style("visibility","visible")},a}(),m=typeof exports!="undefined"&&exports!==null?exports:this,m.PlaybackComponent=h,m.ModelPlayer=e,i=function(){function a(a,b,
c,d,e){this.svg_element=a,this.playable=b!=null?b:null,this.offsets={reset:0,back:1,play:2,stop:2,forward:3},this.width=200,this.height=34,this.xpos=c,this.ypos=d,this.scale=e||1,this.unit_width=this.width/9,this.vertical_padding=(this.height-this.unit_width)/2,this.stroke_width=this.unit_width/10,this.init_view()}return a.prototype.offset=function(a){return this.offsets[a]*this.unit_width*2+this.unit_width},a.prototype.make_button=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=this;g=this.group.append("svg:g"),m=this.offset(a),g.attr("class","component playbacksvgbutton").attr("x",l).attr("y",this.vertical_padding).attr("width",this.unit_width).attr("height",this.unit_width*2).attr("style","fill: #cccccc"),f=g.append("rect"),f.attr("class","bg").attr("x",m).attr("y",this.vertical_padding/3).attr("width",this.unit_width*2).attr("height",this.unit_width*1.5).attr("rx","0");for(o=0,q=c.length;o<q;o++){j=c[o],d=g.append(b),d.attr("class",""+a+" button-art"),k="";for(p=0,r=j.length;p<r;p++)i=j[p],l=m+8+i.x*this.unit_width,n=this.vertical_padding/.75+i.y*this.unit_width,k+=" "+l+","+n,d.attr("points",k);a==="stop"&&(e=g.append("rect"),e.attr("class","pause-center").attr("x",l+this.unit_width/3).attr("y",this.vertical_padding/.75-1).attr("width",this.unit_width/3).attr("height",this.unit_width+2))}return h=g.append("rect"),h.attr("class","highlight").attr("x",m+1).attr("y",this.vertical_padding/1.85).attr("width",this.unit_width*2-2).attr("height",this.unit_width/1.4).attr("rx","0"),g.on("click",function(){return s.action(a)}),g},a.prototype.action=function(a){console.log("running "+a+" ");if(this.playable)switch(a){case"play":this.playable.play();break;case"stop":this.playable.stop();break;case"forward":this.playable.forward();break;case"back":this.playable.back();break;case"reset":this.playable.seek(1);break;default:console.log("cant find action for "+a)}else console.log("no @playable defined");return this.update_ui()},a.prototype.init_reset_button=function(){var a;return a=[[{x:0,y:0},{x:0,y:1},{x:1,y:1},{x:1,y:0},{x:.25,y:0},{x:.5,y:.25}]],this.reset=this.make_button("reset","svg:polyline",a)},a.prototype.init_play_button=function(){var a;return a=[[{x:0,y:0},{x:1,y:.5},{x:0,y:1}]],this.play=this.make_button("play","svg:polygon",a)},a.prototype.init_stop_button=function(){var a;return a=[[{x:0,y:0},{x:1,y:0},{x:1,y:1},{x:0,y:1},{x:0,y:0}]],this.stop=this.make_button("stop","svg:polygon",a)},a.prototype.init_pause_button=function(){var a;return a=[[{x:.5,y:.5},{x:.5,y:0},{x:.5,y:1},{x:0,y:1},{x:0,y:0}]],this.pause=this.make_button("pause","svg:polygon",a)},a.prototype.init_back_button=function(){var a;return a=[[{x:.5,y:0},{x:0,y:.5},{x:.5,y:1}],[{x:1,y:0},{x:.5,y:.5},{x:1,y:1}]],this.back=this.make_button("back","svg:polyline",a)},a.prototype.init_forward_button=function(){var a;return a=[[{x:.5,y:0},{x:1,y:.5},{x:.5,y:1}],[{x:0,y:0},{x:.5,y:.5},{x:0,y:1}]],this.forward=this.make_button("forward","svg:polyline",a)},a.prototype.init_view=function(){return this.svg=this.svg_element.append("svg:svg").attr("class","component playbacksvg").attr("x",this.xpos).attr("y",this.ypos),this.group=this.svg.append("g").attr("transform","scale("+this.scale+","+this.scale+")").attr("width",this.width).attr("height",this.height),this.init_reset_button(),this.init_back_button(),this.init_play_button(),this.init_stop_button(),this.init_forward_button(),this.playable.playing?this.hide(this.play):this.hide(this.stop)},a.prototype.position=function(a,b,c){return this.xpos=a,this.ypos=b,this.scale=c||1,this.svg.attr("x",this.xpos).attr("y",this.ypos),this.group.attr("transform","scale("+this.scale+","+this.scale+")").attr("width",this.width).attr("height",this.height)},a.prototype.update_ui=function(){if(this.playable)return this.playable.playing?(this.hide(this.play),this.show(this.stop)):(this.hide(this.stop),this.show(this.play))},a.prototype.hide=function(a){return a.style("visibility","hidden")},a.prototype.show=function(a){return a.style("visibility","visible")},a}(),m=typeof exports!="undefined"&&exports!==null?exports:this,m.PlaybackComponentSVG=i,m.ModelPlayer=e,j=function(){function a(a,b,c,d,e){this.dom_id=a!=null?a:"#slider",this.value_changed_function=b,this.min=c,this.max=d,this.value=e,this.dom_element=$(this.dom_id),this.dom_element.addClass("component").addClass("slider"),this.min=this.min||this.dom_element.attr("data-min")||0,this.max=this.max||this.dom_element.attr("data-max")||1,this.value=this.value||this.dom_element.attr("data-value")||.5,this.precision=this.dom_element.attr("data-precision")||3,this.label=this.dom_element.attr("data-label"),this.domain=this.max-this.min,this.mouse_down=!1,this.width=this.dom_element.width(),this.height=this.dom_element.height(),this.init_view(),this.init_mouse_handlers()}return a.prototype.horizontal_orientation=function(){if(this.width>this.height)return!0},a.prototype.init_view=function(){var a;return this.slider_well=$("<div>").addClass("slider_well"),this.dom_element.append(this.slider_well),a=this.width/2,this.y1=this.height,this.y2=0,this.x1=this.x2=a,this.handle_y=(this.y1+this.y2)/2,this.handle_x=(this.x1+this.x2)/2,this.horizontal_orientation()&&(a=this.height/4,this.y1=this.y2=a,this.x1=0,this.x2=this.width,this.handle_y=(this.y1+this.y2)/2,this.handle_x=this.value/this.domain*this.width),this.init_slider_fill(),this.slider_well_height=this.slider_well.height(),this.slider_well_width=this.slider_well.width(),this.init_handle(),this.init_label()},a.prototype.init_slider_fill=function(){return this.slider_fill=$("<div>").addClass("slider_fill"),this.slider_well.append(this.slider_fill),this.horizontal_orientation()?this.slider_fill.addClass("horizontal"):this.slider_fill.addClass("vertical"),this.update_slider_filled()},a.prototype.update_slider_filled=function(){return this.horizontal_orientation()?this.slider_fill.width(""+this.handle_x+"px"):this.slider_fill.height(""+this.handle_y+"px")},a.prototype.init_handle=function(){return this.handle=$("<div>").addClass("handle"),this.slider_well.append(this.handle),this.handle_width=parseInt(this.handle.width()),this.handle_height=parseInt(this.handle.height()),this.handle_width_offset=this.handle_width/2-(this.handle_width-this.slider_well_width)/2,this.handle_height_offset=this.handle_height/2-(this.handle_height-this.slider_well_height)/4,this.update_handle()},a.prototype.update=function(){return this.update_handle(),this.update_slider_filled(),this.update_label()},a.prototype.update_handle=function(){return this.handle.css("left",""+(this.handle_x-this.handle_width/2)+"px").css("top",""+(this.handle_y-this.handle_height_offset)+"px")},a.prototype.init_label=function(){return this.text_label=$("<div/>").addClass("label"),this.dom_element.append(this.text_label),this.update_label()},a.prototype.set_scaled_value=function(a){return this.value=(a-this.min)/this.domain,this.handle_x=a/this.domain*this.width,this.update()},a.prototype.scaled_value=function(){var a;return a=this.value,a*=this.max-this.min,a+=this.min,a},a.prototype.update_label=function(){var a;return this.label?(a=this.scaled_value().toFixed(this.precision),this.text_label.text(""+this.label+": "+a)):this.text_label.hide()},a.prototype.handle_mousedown=function(a){var b=this;return this.dragging=!0,$(document).bind("mouseup.drag",this.documentMouseUpDelegate=function(a){return b.handle_mouseup(a)}),$(document).bind("mousemove.drag",this.documentMouseMoveDelegate=function(a){return b.handle_drag(a)}),this.handle_drag(a)},a.prototype.handle_drag=function(a){var b,c,d,e;return this.dragging?(document.onselectstart=function(){return!1},d=a.pageX-this.slider_well.position().left,e=a.pageY-this.slider_well.position().top,this.horizontal_orientation()?(b=this.width-this.handle_width/4,c=this.handle_width/4,this.handle_x=d,this.handle_x<c&&(this.handle_x=c),this.handle_x>b&&(this.handle_x=b),this.value=this.handle_x/this.width):(this.handle_y=a.y,this.handle.attr("cy",this.handle_y),this.slider_fill.attr("y",this.handle_y).attr("height",this.height-this.handle_y),this.value=this.handle_y/this.height),typeof this.value_changed_function=="function"&&this.value_changed_function(this.scaled_value()),this.update()):!1},a.prototype.handle_mouseup=function(){return document.onselectstart=function(){return!0},this.dragging&&($(document).unbind("mousemove",this.documentMouseMoveDelegate),$(document).unbind("mouseup",this.documentMouseUpDelegate),this.dragging=!1),!0},a.prototype.init_mouse_handlers=function(){var a=this;return this.slider_well.bind("mousedown",this.documentMouseUpDelegate=function(b){return a.handle_mousedown(b)})},a}(),m=typeof exports!="undefined"&&exports!==null?exports:this,m.SliderComponent=j,k=function(){function a(a,b,c,d){this.dom_id=a!=null?a:"#thermometer",this.min=c,this.max=d,this.resize=p(this.resize,this),this.dom_element=$(this.dom_id),this.dom_element.addClass("thermometer"),this.samples=[],this.samples.push(b),this.value=b,this.first_sample=!0,this.last_draw_time=(new Date).getTime(),this.sample_interval_ms=250,this.last_draw_time-=this.sample_interval_ms,this.init_view()}return a.prototype.init_view=function(){var a;return this.width=this.dom_element.width(),this.height=this.dom_element.height(),a=this.width/2,this.y1=this.height,this.y2=0,this.x1=this.x2=a,this.init_thermometer_fill(),d3.select("#therm_text").attr("class","therm_text")},a.prototype.init_thermometer_fill=function(){return this.thermometer_fill=$("<div>").addClass("thermometer_fill"),this.dom_element.append(this.thermometer_fill),this.redraw()},a.prototype.resize=function(){var a;return this.width=this.dom_element.width(),this.height=this.dom_element.height(),a=this.width/2,this.y1=this.height,this.y2=0,this.x1=this.x2=a,this.redraw()},a.prototype.set_scaled_value=function(a){var b;return b=this.value,b*=this.max-this.min,b+=this.min,b},a.prototype.scaled_value=function(){var a;return a=this.value,a*=this.max-this.min,a+=this.min,a},a.prototype.time_to_redraw=function(){var a;return a=(new Date).getTime(),a>this.last_draw_time+this.sample_interval_ms},a.prototype.add_value=function(a){this.samples.push(a),this.value=a;if(this.time_to_redraw()||this.first_sample)return this.first_sample=!1,this.redraw(),this.samples=[]},a.prototype.get_avg=function(){var a,b,c,d,e;if(this.samples.length>0){b=0,e=this.samples;for(c=0,d=e.length;c<d;c++)a=e[c],b+=a;return this.value=b/this.samples.length}return this.value},a.prototype.scaled_display_value=function(){return this.get_avg()/(this.max-this.min)*this.height},a.prototype.redraw=function(){var a,b;return this.width=this.dom_element.width(),this.height=this.dom_element.height(),a=this.width/2,this.y1=this.height,this.y2=0,this.x1=this.x2=a,b=this.scaled_display_value(),this.thermometer_fill.css("bottom",""+(b-this.height)+"px"),this.thermometer_fill.height(""+b+"px"),this.last_draw_time=(new Date).getTime(),d3.select("#therm_text").text("Temperature")},a}(),m=typeof exports!="undefined"&&exports!==null?exports:this,m.Thermometer=k}.call(this),function(){typeof console=="undefined"&&(window.console={},console.log=console.info=console.warn=console.error=function(){}),controllers={version:"0.0.1"},controllers.simpleModelController=function(a,b,c){function w(){function b(){model=modeler.model({elements:i,model_listener:r,temperature:m,lennard_jones_forces:!0,coulomb_forces:n,temperature_control:l,width:o,height:p});if(j)model.createNewAtoms(j);else{if(!k)throw new Error("simpleModelController: tried to create a model without atoms or mol_number.");model.createNewAtoms(k),model.relax()}}function c(){layout.selection=d,model_player=new ModelPlayer(model,e),q=layout.moleculeContainer(a,{xmax:o,ymax:p}),q.updateMoleculeRadius(),q.setup_particles(),t=new Thermometer("#thermometer",model.temperature(),200,4e3),model.addPropertiesListener(["temperature"],h),t.resize(),h(),layout.heatCoolButtons("#heat_button","#cool_button",0,3800,model,function(a){t.add_value(a)}),model.addPropertiesListener(["coulomb_forces"],g),g(),v={moleculeContainers:[q],thermometers:[t]},layout.setupScreen(v)}function g(){$(layout.coulomb_forces_checkbox).attr("checked",model.get("coulomb_forces")),q.setup_particles()}function h(){t.add_value(model.get("temperature"))}function u(){model.stop()}function w(){model.on("tick",r),(!Number(f)||model.stepCounter()<f)&&model.resume()}function x(){u(),model.stepBack()}function y(){(!Number(f)||model.stepCounter()<f)&&model.stepForward()}function z(){atoms=model.get_atoms(),nodes=model.get_nodes(),model.resetTime(),u(),model.on("tick",r),s=model.stepCounter()}function A(){layout.setupScreen(v),t.resize(),h()}function B(a){a=a?a:window.event?event:null;if(a)switch(a.keyCode){case 32:model.is_stopped()?q.playback_component.action("play"):q.playback_component.action("stop"),a.preventDefault();break;case 13:q.playback_component.action("play"),a.preventDefault();break;case 37:model.is_stopped()||q.playback_component.action("stop"),x(),a.preventDefault();break;case 39:model.is_stopped()||q.playback_component.action("stop"),y(),a.preventDefault()}}r=function(a){q.update_molecule_positions(),s>=model.stepCounter()&&u()},document.onwebkitfullscreenchange=A,window.onresize=A,document.onkeydown=B;try{b(),z(),c()}catch(C){throw alert(C),new Error(C)}e&&w()}var d=c.layoutStyle,e=c.autostart,f=c.maximum_model_steps,g=c.lj_epsilon_max,h=c.lj_epsilon_min,i=b.elements,j=b.atoms,k=b.mol_number,l=b.temperature_control,m=b.temperature,n=b.coulomb_forces,o=b.width,p=b.height,q,r,s,t,u,v;return w(),w},controllers.compareModelsController=function(a,b,c,d){function I(){function d(a){r.update_molecule_positions()}function g(){model=modeler.model({elements:j,model_listener:d,temperature:n,lennard_jones_forces:!0,coulomb_forces:o,temperature_control:m,width:p,height:q});if(k)model.createNewAtoms(k);else{if(!l)throw new Error("simpleModelController: tried to create a model without atoms or mol_number.");model.createNewAtoms(l),model.relax()}}function h(){layout.selection=e,model_player=new ModelPlayer(model,f),r=layout.moleculeContainer(a,{playback_controller:!1,play_only_controller:!1,model_time_label:!0,grid_lines:!0,xunits:!0,yunits:!0,xmax:p,ymax:q}),r.updateMoleculeRadius(),r.setup_particles(),B=I(document.location.hash),B?z={params:[["script","page:0:import "+B]]}:z={},y=layout.appletContainer(b,z),w={moleculeContainers:[r],appletContainers:[y]},layout.setupScreen(w)}function i(){model.stop()}function s(){model.on("tick",d),model.resume()}function u(){model.stop(),model.stepBack()}function v(){model.stop(),model.stepForward()}function x(){model.stop(),g(),A(),d()}function A(){atoms=model.get_atoms(),nodes=model.get_nodes(),model.resetTime(),i(),model.on("tick",d),t=model.stepCounter()}function I(a){var b=/#*(.*?)(\$.*|\.json$)/,c;return c=b.exec(a)[1],c?c.replace("/converted","")+".cml":!1}function J(a){var b=/#*\/imports\/legacy-mw-content\/converted\/(.*?)\.json$/,c;return c=b.exec(a)[1],c?c:!1}function K(a){return y.applet.runMwScript(a)}function L(){var a="/imports/legacy-mw-content/converted/"+F.value+".json",b=I(a);document.location.hash="#"+a,z.params=[["script","page:0:import "+b]],$.get(a).done(function(a){G=a,H.resolve()}).fail(function(){$("#flash").html('<p class="error-message">Could not load config '+document.location.hash+"</p>"),H.resolve()})}function M(){F.value=J(document.location.hash),K("page:0:set %frank false")}function N(){layout.setupScreen(w)}function O(a){a=a?a:window.event?event:null;if(a)switch(a.keyCode){case 32:model.is_stopped()?r.playback_component.action("play"):r.playback_component.action("stop"),a.preventDefault();break;case 13:r.playback_component.action("play"),a.preventDefault();break;case 37:model.is_stopped()||r.playback_component.action("stop"),u(),a.preventDefault();break;case 39:model.is_stopped()||r.playback_component.action("stop"),v(),a.preventDefault()}}C=document.getElementById("start"),C.onclick=function(){K("mw2d:1:run"),s()},D=document.getElementById("stop"),D.onclick=function(){K("mw2d:1:stop"),i()},E=document.getElementById("reset"),E.onclick=function(){K("mw2d:1:reset"),x()},F=document.getElementById("model-select"),$.when(H).done(function(a){$.extend(c,G),x()}),F.onchange=L,document.onwebkitfullscreenchange=N,window.onresize=N,document.onkeydown=O;try{g(),A(),h(),M()}catch(P){throw alert(P),new Error(P)}}var e=d.layoutStyle,f=d.autostart,g=d.maximum_model_steps,h=d.lj_epsilon_max,i=d.lj_epsilon_min,j=c.elements,k=c.atoms,l=c.mol_number,m=c.temperature_control,n=c.temperature,o=c.coulomb_forces,p=c.width,q=c.height,r,s,t,u,v,w,x,y,z={},A,B,C,D,E,F,G,H=$.Deferred();return I(),I},controllers.complexModelController=function(a,b,c,d,e,f){function N(){function e(a){var b=model.ke(),c=model.pe(),d=b+c;J.update(),v.update_molecule_positions(),model.isNewStep()?(M++,C.push(d),model.is_stopped()?A.add_point(d):A.add_canvas_point(d)):A.update(),x>.95*A.xmax&&A.xmax<i&&A.change_xaxis(A.xmax*2),x>=i&&B(),layout.displayStats(),layout.datatable_visible&&layout.render_datatable()}function f(){C=[model.ke()+model.pe()]}function w(){model=modeler.model({elements:n,model_listener:e,temperature:q,lennard_jones_forces:!0,coulomb_forces:s,temperature_control:r,width:t,height:u});if(o)model.createNewAtoms(o);else{if(!p)throw new Error("simpleModelController: tried to create a model without atoms or mol_number.");model.createNewAtoms(p),model.relax()}}function y(){function e(){$(layout.coulomb_forces_checkbox).attr("checked",model.get("coulomb_forces")),v.setup_particles()}function i(){p=+F.value,S(),checkbox_thermalize.checked&&(model.relax(),v.update_molecule_positions()),L.checked=!1,o()}function o(){A.change_yaxis(G[p]),I.redraw(),J.redraw()}layout.selection=g,model_player=new ModelPlayer(model,h),v=layout.moleculeContainer(a,{title:"Simple Molecules",xlabel:"X position (nm)",ylabel:"Y position (nm)",playback_controller:!0,play_only_controller:!1,model_time_label:!0,grid_lines:!0,xunits:!0,yunits:!0,atom_mubers:!1,xmin:0,xmax:t,ymin:0,ymax:u}),model.addPropertiesListener(["sigma"],v.updateMoleculeRadius),f(),A=grapher.realTimeGraph(b,{title:"Total Energy of the System",xlabel:"Model Time (ps)",xmin:0,xmax:2500,sample:.25,ylabel:null,ymin:0,ymax:200,dataset:C}),A.new_data(C),model.on("play",function(){A.number_of_points()&&M<A.number_of_points()&&(M===0?f():C.length=M,A.new_data(C)),A.show_canvas()}),model.on("stop",function(){A.hide_canvas()}),model.on("seek",function(){f(),A.new_data(C)}),J=layout.speedDistributionChart(d,{title:"Distribution of Speeds",xlabel:null,ylabel:"Count",xmax:2,xmin:0,ymax:15,ymin:0,quantile:.01}),I=layout.potentialChart(c,model,{title:"Lennard-Jones potential",xlabel:"Radius",ylabel:"Potential Energy",epsilon_max:j,epsilon_min:k,epsilon:n[0].epsilon,sigma_max:l,sigma_min:m,sigma:n[0].sigma}),model.addPropertiesListener(["epsilon"],I.ljUpdate),model.addPropertiesListener(["sigma"],I.ljUpdate),model.addPropertiesListener(["coulomb_forces"],e),e(),K={moleculeContainers:[v],potentialCharts:[I],speedDistributionCharts:[J],energyCharts:[A]},D=document.getElementById("model-controls"),D&&(E=D.getElementsByTagName("input"),D.onchange=modelController),F=document.getElementById("select-molecule-number"),L=document.getElementById("radio-randomize-pos-vel"),checkbox_thermalize=document.getElementById("checkbox-thermalize"),G={2:2,5:12.5,10:5,20:10,50:120,100:250,200:1e3,500:5e3},H={2:2,5:2,10:5,20:5,50:10,100:15,200:20,500:40},F.onchange=i,L.onclick=i,F.value=p}function z(){atoms=model.get_atoms(),nodes=model.get_nodes(),model.resetTime(),f(),v.updateMoleculeRadius(),v.setup_particles(),layout.setupScreen(K),x=model.stepCounter(),F.value=atoms.length,B(),model.on("tick",e)}function B(){model.stop(),A.hide_canvas(),v.playback_component.action("stop"),D&&(E[0].checked=!0)}function O(){model.stop(),model.stepCounter()<i?(model.stepForward(),A.hide_canvas(),D&&(E[0].checked=!0)):D&&(E[0].checked=!1)}function P(){model.on("tick",e),model.stepCounter()<i?(A.show_canvas(),model.resume(),D&&(E[0].checked=!0)):D&&(E[0].checked=!1)}function Q(){B(),M=model.stepBack(),A.showMarker(M)}function R(){model.stepCounter()<i?(M=model.stepForward(),A.showMarker(M)):D&&(E[0].checked=!0)}function S(){p=+F.value,model.createNewAtoms(p),z(),x=model.stepCounter(),layout.displayStats(),layout.datatable_visible?layout.render_datatable(!0):layout.hide_datatable(),f(),A.new_data(C),A.hide_canvas(),D&&(E[0].checked=!0)}function T(){layout.setupScreen(K)}function U(a){a=a?a:window.event?event:null;if(a)switch(a.keyCode){case 32:model.is_stopped()?v.playback_component.action("play"):v.playback_component.action("stop"),a.preventDefault();break;case 13:v.playback_component.action("play"),a.preventDefault();break;case 37:model.is_stopped()||v.playback_component.action("stop"),Q(),a.preventDefault();break;case 39:model.is_stopped()||v.playback_component.action("stop"),R(),a.preventDefault()}}document.onwebkitfullscreenchange=T,window.onresize=T,document.onkeydown=U;try{w(),y(),z()}catch(V){throw alert(V),new Error(V)}h&&P(),N.modelListener=e,N.modelGo=P,N.modelStop=B,N.modelReset=S,N.resetTEData=f,N.energyGraph=A,N.moleculeContainer=v}var g=f.layoutStyle,h=f.autostart,i=f.maximum_model_steps,j=f.lj_epsilon_max,k=f.lj_epsilon_min,l=2,m=.1,n=e.elements,o=e.atoms,p=e.mol_number,q=e.temperature,r=e.temperature_control,s=e.coulomb_forces,t=e.width,u=e.height,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,F,L,M=0;return N(),N}}();