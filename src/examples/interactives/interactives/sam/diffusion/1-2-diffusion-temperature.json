{
  "title": "Diffusion Temperature",
  "publicationStatus": "draft",
  "subtitle": "How does temperature affect the rate of diffusion?",
  "about": "Click remove barrier to begin measuring how long it takes for the blue molecules to diffuse across the container.",
  "models": [
    {
      "id": "model1",
      "url": "/imports/legacy-mw-content/converted/sam-activities/diffusion/DiffusionTemp/DiffusionBarrier$0.json",
      "viewOptions": {
        "controlButtons": "play_reset",
        "imageMapping": {
          "GasSensor.png": "GasSensor.svg"
        }
      },
      "modelOptions": {
        "unitsScheme": "mks"
      },
      "onLoad": [
        "set('targetTemperature',500);",
        "start();",
        "set({ timeStep: 0.00015, timeStepsPerTick: 75, modelSampleRate: 'default' });",
        "onPropertyChange('time', function(t) {",
        "  var atoms               = atomsWithin(6.75,1.96,0.25,1.96,2);",
        "  var nNewAtomsInTarget   = 0;",
        "  var nAtomsInTargetTotal = get('nAtomsInTargetTotal')",
        "  for( var i = 0; i < atoms.length; i++) {",
        "    if (!getAtomProperties(atoms[i]).pinned) { ",
        "      setAtomProperties(atoms[i], {pinned: 1});",
        "      nNewAtomsInTarget++;",
        "    }",
        "  }",
        "  set('nAtomsInTargetTotal', nAtomsInTargetTotal + nNewAtomsInTarget);",
        "  set('experimentTime', get('experimentRunning') ? t - get('timeBarrierRemoved') : 0);",
        "});"
      ]
    }
  ],
  "parameters": [
    {
      "name": "tracedAtom",
      "initialValue": -99,
      "onChange": ""
    },
    {
      "name": "nAtomsInTargetTotal",
      "initialValue": 0,
      "onChange": "if (value >= 3) { stop() }"
    },
    {
      "name": "wasMarked",
      "initialValue": 0,
      "onChange": ""
    },
    {
      "name": "timeBarrierRemoved",
      "initialValue": 0,
      "onChange": ""
    },
    {
      "name": "experimentRunning",
      "initialValue": false,
      "onChange": ""
    },
    {
      "name": "experimentTime",
      "label": "Experiment Time",
      "unitType": "time",
      "initialValue": 0,
      "onChange": ""
    },
    {
      "name": "selectedTemperature",
      "initialValue": 2,
      "onChange": [
        "var targets = [100, 250, 500, 1500, 2500];",
        "set('targetTemperature', targets[value]);"
      ]
    }
  ],
  "components": [
    {
      "type": "button",
      "id": "remove-obstacle",
      "text": "Remove Barrier",
      "action" : [
        "if (getNumberOfObstacles() > 0) { ",
        "  removeObstacle(0); ",
        "  set('timeBarrierRemoved', get('time'));",
        "  set('experimentRunning', true)",
        "}"
      ]
    },
    {
      "type": "button",
      "id": "reset-barrier",
      "text": "Reset Experiment",
      "action" : [
        "reset();"
      ]
    },
    {
      "type": "slider",
      "id": "temperature-slider",
      "min": 0,
      "max": 4,
      "labels": [
        {
          "value": 0,
          "label": "Low"
        },
        {
          "value": 2,
          "label": "Medium"
        },
        {
          "value": 4,
          "label": "High"
        }
      ],
      "steps": 4,
      "title": "Temperature",
      "property": "selectedTemperature"
    },
    {
      "type": "thermometer",
      "id": "thermometer",
      "min": 0,
      "max": 3000,
      "width": "15%"
    },
    {
      "type": "numericOutput",
      "id": "experiment-time",
      "property": "experimentTime",
      "displayValue": "return format('1.1f')(value)"
    }
  ],
  "layout": {
    "bottom": [
      ["temperature-slider","experiment-time"],
      ["remove-obstacle","reset-barrier"]
    ],
    "right": [
      "thermometer"
    ]
  }
}